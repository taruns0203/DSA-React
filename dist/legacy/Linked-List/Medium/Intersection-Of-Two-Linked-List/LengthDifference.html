<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Length Difference Technique - Linked List Intersection | Whiteboard
    </title>
    <link
      href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Patrick+Hand&family=Kalam:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Kalam", cursive;
        min-height: 100vh;
        overflow-x: hidden;
      }

      .whiteboard {
        min-height: 100vh;
        background: linear-gradient(
            rgba(200, 210, 220, 0.3) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgba(200, 210, 220, 0.3) 1px, transparent 1px),
          linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #f1f3f5 100%);
        background-size: 30px 30px, 30px 30px, 100% 100%;
        padding: 30px;
        position: relative;
      }

      .whiteboard::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
        pointer-events: none;
        z-index: 1;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        position: relative;
        z-index: 2;
      }

      .title {
        font-family: "Caveat", cursive;
        font-size: 3.2rem;
        font-weight: 700;
        color: #2d3436;
        text-align: center;
        margin-bottom: 10px;
        transform: rotate(-1deg);
        text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.05);
      }

      .subtitle {
        font-family: "Patrick Hand", cursive;
        font-size: 1.4rem;
        color: #636e72;
        text-align: center;
        margin-bottom: 40px;
        transform: rotate(0.5deg);
      }

      .section-box {
        background: rgba(255, 255, 255, 0.7);
        border: 3px solid #2d3436;
        border-radius: 3px;
        padding: 25px;
        margin-bottom: 30px;
        position: relative;
        box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.1);
        transform: rotate(-0.3deg);
      }

      .section-box::before {
        content: "";
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        border: 2px solid rgba(45, 52, 54, 0.3);
        border-radius: 5px;
        transform: rotate(0.5deg);
        pointer-events: none;
      }

      .section-title {
        font-family: "Caveat", cursive;
        font-size: 2rem;
        font-weight: 600;
        color: #0984e3;
        margin-bottom: 15px;
        display: inline-block;
        padding: 5px 15px;
        background: linear-gradient(
          180deg,
          transparent 60%,
          rgba(116, 185, 255, 0.3) 60%
        );
        transform: rotate(-0.5deg);
      }

      /* Phase indicator - 3 phases */
      .phase-indicator {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .phase-badge {
        padding: 10px 20px;
        border-radius: 30px;
        font-family: "Patrick Hand", cursive;
        font-size: 1.1rem;
        border: 3px solid;
        transition: all 0.3s ease;
        opacity: 0.4;
        text-align: center;
      }

      .phase-badge.phase-1 {
        background: linear-gradient(135deg, #dfe6e9 0%, #b2bec3 100%);
        border-color: #636e72;
        color: #2d3436;
      }

      .phase-badge.phase-2 {
        background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
        border-color: #f39c12;
        color: #d35400;
      }

      .phase-badge.phase-3 {
        background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
        border-color: #00b894;
        color: #006266;
      }

      .phase-badge.active {
        opacity: 1;
        transform: scale(1.1);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .phase-badge.completed {
        opacity: 0.7;
        background: linear-gradient(
          135deg,
          #b2bec3 0%,
          #636e72 100%
        ) !important;
        color: white;
      }

      /* Lists visualization */
      .lists-container {
        display: flex;
        flex-direction: column;
        gap: 50px;
        margin: 30px 0;
        position: relative;
      }

      .list-row {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
        position: relative;
      }

      .list-label {
        font-family: "Caveat", cursive;
        font-size: 1.8rem;
        font-weight: 600;
        min-width: 80px;
        transform: rotate(-2deg);
      }

      .list-a-label {
        color: #d63031;
      }
      .list-b-label {
        color: #6c5ce7;
      }

      .list-info {
        font-family: "Patrick Hand", cursive;
        font-size: 1rem;
        color: #636e72;
        margin-left: 10px;
        padding: 5px 12px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 15px;
        border: 2px dashed #b2bec3;
      }

      .node {
        width: 55px;
        height: 55px;
        border: 3px solid #2d3436;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Kalam", cursive;
        font-size: 1.4rem;
        font-weight: 700;
        position: relative;
        transition: all 0.3s ease;
        background: white;
      }

      .node-a {
        background: linear-gradient(135deg, #fff5f5 0%, #ffe3e3 100%);
        border-color: #d63031;
      }

      .node-b {
        background: linear-gradient(135deg, #f3f0ff 0%, #e5dbff 100%);
        border-color: #6c5ce7;
      }

      .node-shared {
        background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
        border-color: #00b894;
      }

      .node.counting {
        animation: countPulse 0.3s ease;
      }

      @keyframes countPulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
          background: #ffeaa7;
        }
        100% {
          transform: scale(1);
        }
      }

      .node.skipped {
        opacity: 0.4;
        transform: scale(0.9);
      }

      .node.pointer-a {
        box-shadow: 0 0 0 4px #d63031, 0 0 20px rgba(214, 48, 49, 0.5);
        transform: scale(1.1);
      }

      .node.pointer-b {
        box-shadow: 0 0 0 4px #6c5ce7, 0 0 20px rgba(108, 92, 231, 0.5);
        transform: scale(1.1);
      }

      .node.pointer-both {
        box-shadow: 0 0 0 4px #00b894, 0 0 25px rgba(0, 184, 148, 0.6);
        transform: scale(1.15);
      }

      .node.found {
        box-shadow: 0 0 0 5px #00b894, 0 0 30px rgba(0, 184, 148, 0.6);
        animation: pulse 0.5s ease infinite alternate;
      }

      @keyframes pulse {
        from {
          box-shadow: 0 0 0 5px #00b894, 0 0 30px rgba(0, 184, 148, 0.6);
        }
        to {
          box-shadow: 0 0 0 8px #00b894, 0 0 40px rgba(0, 184, 148, 0.8);
        }
      }

      /* Pointer labels */
      .pointer-label {
        position: absolute;
        font-family: "Caveat", cursive;
        font-size: 1.2rem;
        font-weight: 700;
        padding: 3px 10px;
        border-radius: 10px;
        white-space: nowrap;
        z-index: 20;
        transition: all 0.3s ease;
      }

      .pointer-label-a {
        background: #d63031;
        color: white;
        top: -35px;
      }

      .pointer-label-b {
        background: #6c5ce7;
        color: white;
        bottom: -35px;
      }

      /* Arrow */
      .arrow {
        width: 25px;
        height: 3px;
        background: #2d3436;
        position: relative;
        margin: 0 -3px;
      }

      .arrow::after {
        content: "";
        position: absolute;
        right: -2px;
        top: -5px;
        border: 5px solid transparent;
        border-left: 8px solid #2d3436;
      }

      /* Length calculation display */
      .length-calc-container {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin: 30px 0;
        flex-wrap: wrap;
      }

      .length-box {
        background: white;
        border: 4px solid;
        border-radius: 15px;
        padding: 20px 30px;
        text-align: center;
        min-width: 180px;
        transition: all 0.3s ease;
      }

      .length-box.list-a-box {
        border-color: #d63031;
        box-shadow: 4px 4px 0px rgba(214, 48, 49, 0.3);
      }

      .length-box.list-b-box {
        border-color: #6c5ce7;
        box-shadow: 4px 4px 0px rgba(108, 92, 231, 0.3);
      }

      .length-box.diff-box {
        border-color: #f39c12;
        background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
        box-shadow: 4px 4px 0px rgba(243, 156, 18, 0.3);
      }

      .length-box-label {
        font-family: "Patrick Hand", cursive;
        font-size: 1.1rem;
        color: #636e72;
        margin-bottom: 8px;
      }

      .length-box-value {
        font-family: "Caveat", cursive;
        font-size: 2.5rem;
        font-weight: 700;
      }

      .length-box.list-a-box .length-box-value {
        color: #d63031;
      }
      .length-box.list-b-box .length-box-value {
        color: #6c5ce7;
      }
      .length-box.diff-box .length-box-value {
        color: #d35400;
      }

      .length-box.active {
        transform: scale(1.1);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      }

      /* Formula display */
      .formula-display {
        background: rgba(116, 185, 255, 0.2);
        border: 3px dashed #0984e3;
        border-radius: 10px;
        padding: 15px 25px;
        margin: 20px auto;
        max-width: 600px;
        text-align: center;
        font-family: "Kalam", cursive;
        font-size: 1.3rem;
        color: #2d3436;
      }

      .formula-display .highlight {
        background: #ffeaa7;
        padding: 2px 8px;
        border-radius: 5px;
        font-weight: 700;
      }

      /* Controls */
      .controls {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
        margin: 30px 0;
      }

      .btn {
        font-family: "Patrick Hand", cursive;
        font-size: 1.2rem;
        padding: 12px 25px;
        border: 3px solid #2d3436;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        background: white;
      }

      .btn:hover {
        transform: translateY(-3px) rotate(-1deg);
        box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.2);
      }

      .btn:active {
        transform: translateY(0);
        box-shadow: none;
      }

      .btn-primary {
        background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
        color: white;
        border-color: #0984e3;
      }

      .btn-success {
        background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
        color: white;
        border-color: #00b894;
      }

      .btn-danger {
        background: linear-gradient(135deg, #fab1a0 0%, #d63031 100%);
        color: white;
        border-color: #d63031;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      .speed-control {
        display: flex;
        align-items: center;
        gap: 10px;
        font-family: "Patrick Hand", cursive;
        font-size: 1.1rem;
      }

      .speed-control input {
        width: 120px;
        accent-color: #0984e3;
      }

      /* Step info */
      .step-info {
        display: flex;
        justify-content: space-around;
        flex-wrap: wrap;
        gap: 15px;
        margin: 20px 0;
      }

      .step-box {
        background: white;
        border: 3px dashed #636e72;
        border-radius: 10px;
        padding: 12px 20px;
        text-align: center;
        min-width: 120px;
      }

      .step-box-label {
        font-family: "Patrick Hand", cursive;
        font-size: 0.95rem;
        color: #636e72;
        margin-bottom: 5px;
      }

      .step-box-value {
        font-family: "Caveat", cursive;
        font-size: 1.6rem;
        font-weight: 700;
      }

      .step-box-value.red {
        color: #d63031;
      }
      .step-box-value.purple {
        color: #6c5ce7;
      }
      .step-box-value.orange {
        color: #f39c12;
      }
      .step-box-value.blue {
        color: #0984e3;
      }
      .step-box-value.green {
        color: #00b894;
      }

      /* Explanation panel */
      .explanation-panel {
        background: rgba(255, 251, 235, 0.9);
        border: 3px solid #f39c12;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
        transform: rotate(0.3deg);
        box-shadow: 3px 3px 0px rgba(243, 156, 18, 0.3);
      }

      .explanation-title {
        font-family: "Caveat", cursive;
        font-size: 1.5rem;
        color: #e17055;
        margin-bottom: 10px;
      }

      .explanation-text {
        font-family: "Kalam", cursive;
        font-size: 1.15rem;
        color: #2d3436;
        line-height: 1.6;
      }

      /* Code panel */
      .code-panel {
        background: #2d3436;
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
        overflow-x: auto;
        transform: rotate(-0.2deg);
        box-shadow: 5px 5px 0px rgba(0, 0, 0, 0.2);
      }

      .code-line {
        font-family: "Courier New", monospace;
        font-size: 0.9rem;
        color: #dfe6e9;
        padding: 3px 10px;
        border-radius: 3px;
        margin: 2px 0;
        transition: all 0.3s ease;
        white-space: pre;
      }

      .code-line.active {
        background: rgba(116, 185, 255, 0.3);
        border-left: 4px solid #74b9ff;
        color: #fff;
      }

      .code-keyword {
        color: #fd79a8;
      }
      .code-function {
        color: #74b9ff;
      }
      .code-variable {
        color: #55efc4;
      }
      .code-comment {
        color: #636e72;
        font-style: italic;
      }
      .code-operator {
        color: #ffeaa7;
      }
      .code-return {
        color: #fab1a0;
      }
      .code-number {
        color: #fdcb6e;
      }

      /* Result banner */
      .result-banner {
        display: none;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        margin: 20px 0;
        font-family: "Caveat", cursive;
        font-size: 2rem;
        animation: slideIn 0.5s ease;
      }

      @keyframes slideIn {
        from {
          transform: translateY(-20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .result-banner.found {
        display: block;
        background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
        border: 4px solid #00b894;
        color: #00b894;
      }

      /* Key insight box */
      .insight-box {
        background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
        border-radius: 10px;
        padding: 20px;
        color: white;
        margin: 20px 0;
        transform: rotate(-0.5deg);
      }

      .insight-box h3 {
        font-family: "Caveat", cursive;
        font-size: 1.8rem;
        margin-bottom: 10px;
      }

      .insight-box p {
        font-family: "Kalam", cursive;
        font-size: 1.1rem;
        line-height: 1.5;
      }

      /* Complexity box */
      .complexity-box {
        background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
        border-radius: 10px;
        padding: 20px;
        color: white;
        margin: 20px 0;
        transform: rotate(0.5deg);
      }

      .complexity-title {
        font-family: "Caveat", cursive;
        font-size: 1.8rem;
        margin-bottom: 15px;
      }

      .complexity-content {
        display: flex;
        gap: 40px;
        flex-wrap: wrap;
      }

      .complexity-item {
        font-family: "Kalam", cursive;
        font-size: 1.1rem;
      }

      .complexity-item strong {
        font-family: "Caveat", cursive;
        font-size: 1.4rem;
      }

      /* Legend */
      .legend {
        display: flex;
        gap: 25px;
        flex-wrap: wrap;
        justify-content: center;
        margin: 20px 0;
        padding: 15px;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 10px;
        border: 2px dashed #b2bec3;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-family: "Patrick Hand", cursive;
        font-size: 1rem;
      }

      .legend-color {
        width: 22px;
        height: 22px;
        border-radius: 5px;
        border: 2px solid #2d3436;
      }

      .legend-color.red {
        background: linear-gradient(135deg, #fff5f5 0%, #ffe3e3 100%);
        border-color: #d63031;
      }
      .legend-color.purple {
        background: linear-gradient(135deg, #f3f0ff 0%, #e5dbff 100%);
        border-color: #6c5ce7;
      }
      .legend-color.green {
        background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
        border-color: #00b894;
      }

      /* Sticky note */
      .sticky-note {
        background: #fff9c4;
        padding: 15px;
        border-radius: 3px;
        box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.15);
        transform: rotate(-2deg);
        font-family: "Patrick Hand", cursive;
        font-size: 1.05rem;
        max-width: 300px;
        position: relative;
        margin: 15px auto;
      }

      .sticky-note::before {
        content: "üìå";
        position: absolute;
        top: -10px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 1.5rem;
      }

      @media (max-width: 768px) {
        .title {
          font-size: 2.2rem;
        }
        .node {
          width: 45px;
          height: 45px;
          font-size: 1.1rem;
        }
        .controls {
          gap: 10px;
        }
        .btn {
          padding: 10px 15px;
          font-size: 1rem;
        }
        .phase-badge {
          font-size: 0.9rem;
          padding: 8px 12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="whiteboard">
      <div class="container">
        <h1 class="title">üìè Length Difference Technique</h1>
        <p class="subtitle">
          Align the starting points, then walk together to the intersection!
        </p>

        <!-- Phase Indicator -->
        <div class="phase-indicator">
          <div class="phase-badge phase-1" id="phase1Badge">
            üìê Phase 1: Count Lengths
          </div>
          <div class="phase-badge phase-2" id="phase2Badge">
            ‚è© Phase 2: Advance Longer List
          </div>
          <div class="phase-badge phase-3" id="phase3Badge">
            üö∂ Phase 3: Walk Together
          </div>
        </div>

        <!-- Legend -->
        <div class="legend">
          <div class="legend-item">
            <div class="legend-color red"></div>
            <span>List A nodes</span>
          </div>
          <div class="legend-item">
            <div class="legend-color purple"></div>
            <span>List B nodes</span>
          </div>
          <div class="legend-item">
            <div class="legend-color green"></div>
            <span>Shared nodes</span>
          </div>
        </div>

        <!-- Length Calculation Display -->
        <div class="length-calc-container">
          <div class="length-box list-a-box" id="lengthABox">
            <div class="length-box-label">Length of A</div>
            <div class="length-box-value" id="lengthAValue">?</div>
          </div>
          <div class="length-box list-b-box" id="lengthBBox">
            <div class="length-box-label">Length of B</div>
            <div class="length-box-value" id="lengthBValue">?</div>
          </div>
          <div class="length-box diff-box" id="diffBox">
            <div class="length-box-label">Difference</div>
            <div class="length-box-value" id="diffValue">?</div>
          </div>
        </div>

        <!-- Formula Display -->
        <div class="formula-display" id="formulaDisplay">
          After alignment, both pointers are
          <span class="highlight">equidistant</span> from the intersection (or
          end)!
        </div>

        <!-- Lists Visualization -->
        <div class="section-box">
          <div class="section-title">üìä The Linked Lists</div>

          <div class="lists-container">
            <div class="list-row" id="listARow">
              <span class="list-label list-a-label">List A:</span>
              <span class="list-info" id="listAInfo">Length: ?</span>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 8px;
                  flex-wrap: wrap;
                  margin-left: 10px;
                "
              >
                <div
                  class="node node-a"
                  data-list="a"
                  data-index="0"
                  data-id="A0"
                >
                  4
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-a"
                  data-list="a"
                  data-index="1"
                  data-id="A1"
                >
                  1
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-shared"
                  data-list="a"
                  data-index="2"
                  data-id="C0"
                >
                  8
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-shared"
                  data-list="a"
                  data-index="3"
                  data-id="C1"
                >
                  4
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-shared"
                  data-list="a"
                  data-index="4"
                  data-id="C2"
                >
                  5
                </div>
                <div class="arrow"></div>
                <span
                  style="
                    font-family: 'Kalam';
                    font-size: 1.1rem;
                    color: #636e72;
                  "
                  >null</span
                >
              </div>
            </div>

            <div class="list-row" id="listBRow">
              <span class="list-label list-b-label">List B:</span>
              <span class="list-info" id="listBInfo">Length: ?</span>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 8px;
                  flex-wrap: wrap;
                  margin-left: 10px;
                "
              >
                <div
                  class="node node-b"
                  data-list="b"
                  data-index="0"
                  data-id="B0"
                >
                  5
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-b"
                  data-list="b"
                  data-index="1"
                  data-id="B1"
                >
                  6
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-b"
                  data-list="b"
                  data-index="2"
                  data-id="B2"
                >
                  1
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-shared"
                  data-list="b"
                  data-index="3"
                  data-id="C0"
                >
                  8
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-shared"
                  data-list="b"
                  data-index="4"
                  data-id="C1"
                >
                  4
                </div>
                <div class="arrow"></div>
                <div
                  class="node node-shared"
                  data-list="b"
                  data-index="5"
                  data-id="C2"
                >
                  5
                </div>
                <div class="arrow"></div>
                <span
                  style="
                    font-family: 'Kalam';
                    font-size: 1.1rem;
                    color: #636e72;
                  "
                  >null</span
                >
              </div>
            </div>
          </div>

          <div class="sticky-note">
            üí° <strong>Key Insight:</strong> List B is 1 node longer than List
            A.<br />
            If we skip 1 node in B, both pointers will be the same distance from
            the intersection!
          </div>
        </div>

        <!-- Controls -->
        <div class="controls">
          <button class="btn btn-primary" id="startBtn" onclick="start()">
            ‚ñ∂Ô∏è Start
          </button>
          <button
            class="btn btn-success"
            id="stepBtn"
            onclick="step()"
            disabled
          >
            ‚è≠Ô∏è Next Step
          </button>
          <button
            class="btn btn-primary"
            id="autoBtn"
            onclick="toggleAuto()"
            disabled
          >
            üîÑ Auto Play
          </button>
          <button class="btn btn-danger" id="resetBtn" onclick="reset()">
            üîÑ Reset
          </button>
          <div class="speed-control">
            <label>Speed:</label>
            <input
              type="range"
              id="speedSlider"
              min="100"
              max="1500"
              value="500"
              onchange="updateSpeed()"
            />
            <span id="speedLabel">500ms</span>
          </div>
        </div>

        <!-- Step Information -->
        <div class="step-info">
          <div class="step-box">
            <div class="step-box-label">Phase</div>
            <div class="step-box-value blue" id="phaseDisplay">‚Äî</div>
          </div>
          <div class="step-box">
            <div class="step-box-label">Pointer A</div>
            <div class="step-box-value red" id="pointerADisplay">‚Äî</div>
          </div>
          <div class="step-box">
            <div class="step-box-label">Pointer B</div>
            <div class="step-box-value purple" id="pointerBDisplay">‚Äî</div>
          </div>
          <div class="step-box">
            <div class="step-box-label">Steps to Go</div>
            <div class="step-box-value orange" id="stepsToGoDisplay">‚Äî</div>
          </div>
          <div class="step-box">
            <div class="step-box-label">Status</div>
            <div class="step-box-value green" id="statusDisplay">Ready</div>
          </div>
        </div>

        <!-- Explanation Panel -->
        <div class="explanation-panel">
          <div class="explanation-title">üìù What's Happening:</div>
          <div class="explanation-text" id="explanationText">
            Click "Start" to begin. We'll first count both list lengths, then
            advance the pointer on the longer list by the difference, and
            finally walk both pointers together until they meet!
          </div>
        </div>

        <!-- Code Panel -->
        <div class="section-box">
          <div class="section-title">üíª Algorithm Code</div>
          <div class="code-panel">
            <div class="code-line" data-line="1">
              <span class="code-keyword">function</span>
              <span class="code-function">getIntersectionNode</span>(headA,
              headB) {
            </div>
            <div class="code-line" data-line="2">
              <span class="code-comment">// Phase 1: Get lengths</span>
            </div>
            <div class="code-line" data-line="3">
              <span class="code-keyword">const</span>
              <span class="code-variable">lengthA</span> =
              <span class="code-function">getLength</span>(headA);
            </div>
            <div class="code-line" data-line="4">
              <span class="code-keyword">const</span>
              <span class="code-variable">lengthB</span> =
              <span class="code-function">getLength</span>(headB);
            </div>
            <div class="code-line" data-line="5"></div>
            <div class="code-line" data-line="6">
              <span class="code-comment"
                >// Phase 2: Align starting positions</span
              >
            </div>
            <div class="code-line" data-line="7">
              <span class="code-keyword">let</span>
              <span class="code-variable">pA</span> = headA,
              <span class="code-variable">pB</span> = headB;
            </div>
            <div class="code-line" data-line="8">
              <span class="code-keyword">let</span>
              <span class="code-variable">diff</span> = Math.<span
                class="code-function"
                >abs</span
              >(<span class="code-variable">lengthA</span> -
              <span class="code-variable">lengthB</span>);
            </div>
            <div class="code-line" data-line="9"></div>
            <div class="code-line" data-line="10">
              <span class="code-keyword">if</span> (<span class="code-variable"
                >lengthA</span
              >
              <span class="code-operator">></span>
              <span class="code-variable">lengthB</span>) {
            </div>
            <div class="code-line" data-line="11">
              <span class="code-keyword">while</span> (<span
                class="code-variable"
                >diff</span
              ><span class="code-operator">--</span>)
              <span class="code-variable">pA</span> =
              <span class="code-variable">pA</span>.next;
            </div>
            <div class="code-line" data-line="12">
              } <span class="code-keyword">else</span> {
            </div>
            <div class="code-line" data-line="13">
              <span class="code-keyword">while</span> (<span
                class="code-variable"
                >diff</span
              ><span class="code-operator">--</span>)
              <span class="code-variable">pB</span> =
              <span class="code-variable">pB</span>.next;
            </div>
            <div class="code-line" data-line="14">}</div>
            <div class="code-line" data-line="15"></div>
            <div class="code-line" data-line="16">
              <span class="code-comment">// Phase 3: Walk together</span>
            </div>
            <div class="code-line" data-line="17">
              <span class="code-keyword">while</span> (<span
                class="code-variable"
                >pA</span
              >
              <span class="code-operator">!==</span>
              <span class="code-variable">pB</span>) {
            </div>
            <div class="code-line" data-line="18">
              <span class="code-variable">pA</span> =
              <span class="code-variable">pA</span>.next;
            </div>
            <div class="code-line" data-line="19">
              <span class="code-variable">pB</span> =
              <span class="code-variable">pB</span>.next;
            </div>
            <div class="code-line" data-line="20">}</div>
            <div class="code-line" data-line="21">
              <span class="code-return">return</span>
              <span class="code-variable">pA</span>;
              <span class="code-comment">// Either intersection or null</span>
            </div>
            <div class="code-line" data-line="22">}</div>
          </div>
        </div>

        <!-- Result Banner -->
        <div class="result-banner" id="resultBanner"></div>

        <!-- Key Insight Box -->
        <div class="insight-box">
          <h3>üß† Why This Works</h3>
          <p>
            <strong>The Problem:</strong> List A has 2 nodes before
            intersection, List B has 3. They're "out of sync".<br /><br />
            <strong>The Solution:</strong> Skip the extra node(s) in the longer
            list. Now both pointers are exactly the same distance from the
            intersection point.<br /><br />
            <strong>The Magic:</strong> Walking together step-by-step, they MUST
            meet at the intersection (or both reach null if no intersection).
          </p>
        </div>

        <!-- Complexity Box -->
        <div class="complexity-box">
          <div class="complexity-title">‚è±Ô∏è Complexity Analysis</div>
          <div class="complexity-content">
            <div class="complexity-item">
              <strong>Time: O(m + n)</strong><br />
              Count A (m) + Count B (n) + Advance (diff) + Walk (min) ‚âà 2(m+n)
            </div>
            <div class="complexity-item">
              <strong>Space: O(1)</strong><br />
              Only a few pointer and counter variables
            </div>
            <div class="complexity-item">
              <strong>Advantage:</strong><br />
              No extra data structures needed!
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // List structures
      const listA = [
        { val: 4, shared: false, id: "A0" },
        { val: 1, shared: false, id: "A1" },
        { val: 8, shared: true, id: "C0" },
        { val: 4, shared: true, id: "C1" },
        { val: 5, shared: true, id: "C2" },
      ];

      const listB = [
        { val: 5, shared: false, id: "B0" },
        { val: 6, shared: false, id: "B1" },
        { val: 1, shared: false, id: "B2" },
        { val: 8, shared: true, id: "C0" },
        { val: 4, shared: true, id: "C1" },
        { val: 5, shared: true, id: "C2" },
      ];

      const lengthA = 5;
      const lengthB = 6;
      const diff = 1; // B is longer

      let phase = 0;
      let subStep = 0;
      let countA = 0;
      let countB = 0;
      let pointerA = 0;
      let pointerB = 0;
      let stepsToAdvance = 0;
      let isRunning = false;
      let autoPlayInterval = null;
      let speed = 500;
      let found = false;

      function updateSpeed() {
        speed = parseInt(document.getElementById("speedSlider").value);
        document.getElementById("speedLabel").textContent = speed + "ms";
      }

      function start() {
        document.getElementById("startBtn").disabled = true;
        document.getElementById("stepBtn").disabled = false;
        document.getElementById("autoBtn").disabled = false;
        isRunning = true;
        phase = 1;
        subStep = 0;
        countA = 0;
        countB = 0;
        updatePhaseIndicator();
        highlightCode(2, 3);
        setExplanation(
          "Phase 1: First, we need to count the length of both lists. Starting with List A..."
        );
        document.getElementById("phaseDisplay").textContent = "Counting";
        document.getElementById("statusDisplay").textContent = "Running";
      }

      function step() {
        if (found || !isRunning) return;

        clearHighlights();

        if (phase === 1) {
          // Phase 1: Counting lengths
          if (subStep === 0) {
            // Counting List A
            if (countA < listA.length) {
              const node = document.querySelector(
                `.node[data-list="a"][data-index="${countA}"]`
              );
              node.classList.add("counting");
              countA++;
              document.getElementById("lengthAValue").textContent = countA;
              document.getElementById("lengthABox").classList.add("active");
              document.getElementById("lengthBBox").classList.remove("active");
              highlightCode(3);
              setExplanation(
                `Counting List A: visited node ${countA} (value: ${
                  listA[countA - 1].val
                }). Current count: ${countA}`
              );

              if (countA === listA.length) {
                document.getElementById(
                  "listAInfo"
                ).textContent = `Length: ${countA}`;
                setTimeout(() => {
                  subStep = 1;
                  setExplanation(
                    `List A length = ${countA}. Now counting List B...`
                  );
                }, speed / 2);
              }
            }
          } else if (subStep === 1) {
            // Counting List B
            if (countB < listB.length) {
              const node = document.querySelector(
                `.node[data-list="b"][data-index="${countB}"]`
              );
              node.classList.add("counting");
              countB++;
              document.getElementById("lengthBValue").textContent = countB;
              document.getElementById("lengthBBox").classList.add("active");
              document.getElementById("lengthABox").classList.remove("active");
              highlightCode(4);
              setExplanation(
                `Counting List B: visited node ${countB} (value: ${
                  listB[countB - 1].val
                }). Current count: ${countB}`
              );

              if (countB === listB.length) {
                document.getElementById(
                  "listBInfo"
                ).textContent = `Length: ${countB}`;
                setTimeout(() => {
                  // Calculate difference
                  const actualDiff = Math.abs(countA - countB);
                  document.getElementById("diffValue").textContent = actualDiff;
                  document.getElementById("diffBox").classList.add("active");

                  // Move to phase 2
                  phase = 2;
                  subStep = 0;
                  stepsToAdvance = actualDiff;
                  pointerA = 0;
                  pointerB = 0;
                  updatePhaseIndicator();
                  highlightCode(6, 7, 8);

                  const longer = countB > countA ? "B" : "A";
                  setExplanation(
                    `Both lengths found! A=${countA}, B=${countB}. Difference = ${actualDiff}. List ${longer} is longer, so we advance pointer${longer} by ${actualDiff} step(s).`
                  );
                  document.getElementById("phaseDisplay").textContent =
                    "Aligning";
                  document.getElementById(
                    "formulaDisplay"
                  ).innerHTML = `Difference = |${countA} - ${countB}| = <span class="highlight">${actualDiff}</span>. Advance the longer list's pointer!`;
                }, speed / 2);
              }
            }
          }
        } else if (phase === 2) {
          // Phase 2: Advancing the longer list
          if (stepsToAdvance > 0) {
            // B is longer, advance pointerB
            const node = document.querySelector(
              `.node[data-list="b"][data-index="${pointerB}"]`
            );
            node.classList.add("skipped");
            pointerB++;
            stepsToAdvance--;

            highlightCode(12, 13);
            updatePointerDisplay();
            document.getElementById("stepsToGoDisplay").textContent =
              stepsToAdvance;

            setExplanation(
              `Advancing pointerB: skipped node B[${pointerB - 1}] (value: ${
                listB[pointerB - 1].val
              }). ${stepsToAdvance} more step(s) to advance.`
            );

            if (stepsToAdvance === 0) {
              setTimeout(() => {
                phase = 3;
                updatePhaseIndicator();
                highlightCode(16, 17);
                setExplanation(
                  `Alignment complete! Both pointers are now equidistant from the intersection. pointerA at A[${pointerA}], pointerB at B[${pointerB}]. Now we walk together!`
                );
                document.getElementById("phaseDisplay").textContent = "Walking";
                document.getElementById(
                  "formulaDisplay"
                ).innerHTML = `Both pointers are now <span class="highlight">${
                  listA.length - pointerA
                }</span> steps from their list ends. Walking together!`;
                showPointers();
              }, speed / 2);
            }
          } else {
            // No difference, move to phase 3
            phase = 3;
            updatePhaseIndicator();
            highlightCode(16, 17);
            setExplanation(
              `Lists are same length! No advancement needed. Walking together from the start.`
            );
            document.getElementById("phaseDisplay").textContent = "Walking";
          }
        } else if (phase === 3) {
          // Phase 3: Walking together
          showPointers();

          const nodeA = listA[pointerA];
          const nodeB = listB[pointerB];

          // Check if same node
          if (nodeA.id === nodeB.id) {
            // Found intersection!
            found = true;
            const nodeAElem = document.querySelector(
              `.node[data-list="a"][data-index="${pointerA}"]`
            );
            const nodeBElem = document.querySelector(
              `.node[data-list="b"][data-index="${pointerB}"]`
            );
            nodeAElem.classList.add("found");
            nodeBElem.classList.add("found");

            highlightCode(17, 21);
            setExplanation(
              `üéâ FOUND! pointerA (id: ${nodeA.id}) === pointerB (id: ${nodeB.id}). Both pointing to same node with value ${nodeA.val}! This is the intersection.`
            );
            document.getElementById("statusDisplay").textContent = "Found!";
            showResult(nodeA.val);
            stopAuto();
            document.getElementById("stepBtn").disabled = true;
            document.getElementById("autoBtn").disabled = true;
            return;
          }

          // Not same, explain and move
          highlightCode(17, 18, 19);
          setExplanation(
            `Comparing: A[${pointerA}] (id: ${nodeA.id}, val: ${nodeA.val}) vs B[${pointerB}] (id: ${nodeB.id}, val: ${nodeB.val}). Different nodes! Moving both forward.`
          );

          pointerA++;
          pointerB++;
          updatePointerDisplay();

          // Check if we've exhausted (shouldn't happen with intersection)
          if (pointerA >= listA.length || pointerB >= listB.length) {
            found = true;
            highlightCode(21);
            setExplanation(
              "Reached the end. No intersection found (both pointers are null)."
            );
            document.getElementById("statusDisplay").textContent = "Not Found";
            stopAuto();
            document.getElementById("stepBtn").disabled = true;
            document.getElementById("autoBtn").disabled = true;
          }
        }
      }

      function showPointers() {
        // Show pointer A
        if (pointerA < listA.length) {
          const nodeA = document.querySelector(
            `.node[data-list="a"][data-index="${pointerA}"]`
          );
          nodeA.classList.add("pointer-a");
        }

        // Show pointer B
        if (pointerB < listB.length) {
          const nodeB = document.querySelector(
            `.node[data-list="b"][data-index="${pointerB}"]`
          );
          nodeB.classList.add("pointer-b");
        }
      }

      function clearHighlights() {
        document.querySelectorAll(".node").forEach((node) => {
          node.classList.remove(
            "counting",
            "pointer-a",
            "pointer-b",
            "pointer-both",
            "found"
          );
        });
        document.querySelectorAll(".length-box").forEach((box) => {
          box.classList.remove("active");
        });
      }

      function highlightCode(...lines) {
        document.querySelectorAll(".code-line").forEach((line) => {
          line.classList.remove("active");
        });
        lines.forEach((lineNum) => {
          const line = document.querySelector(
            `.code-line[data-line="${lineNum}"]`
          );
          if (line) line.classList.add("active");
        });
      }

      function updatePhaseIndicator() {
        const badges = ["phase1Badge", "phase2Badge", "phase3Badge"];
        badges.forEach((id, idx) => {
          const badge = document.getElementById(id);
          badge.classList.remove("active", "completed");
          if (idx + 1 === phase) {
            badge.classList.add("active");
          } else if (idx + 1 < phase) {
            badge.classList.add("completed");
          }
        });
      }

      function updatePointerDisplay() {
        document.getElementById("pointerADisplay").textContent =
          pointerA < listA.length
            ? `A[${pointerA}]=${listA[pointerA].val}`
            : "null";
        document.getElementById("pointerBDisplay").textContent =
          pointerB < listB.length
            ? `B[${pointerB}]=${listB[pointerB].val}`
            : "null";
      }

      function setExplanation(text) {
        document.getElementById("explanationText").textContent = text;
      }

      function showResult(value) {
        const banner = document.getElementById("resultBanner");
        banner.className = "result-banner found";
        banner.textContent = `‚úÖ Intersection found at node with value ${value}!`;
      }

      function toggleAuto() {
        if (autoPlayInterval) {
          stopAuto();
        } else {
          startAuto();
        }
      }

      function startAuto() {
        document.getElementById("autoBtn").textContent = "‚è∏Ô∏è Pause";
        document.getElementById("stepBtn").disabled = true;
        autoPlayInterval = setInterval(() => {
          if (found) {
            stopAuto();
          } else {
            step();
          }
        }, speed);
      }

      function stopAuto() {
        if (autoPlayInterval) {
          clearInterval(autoPlayInterval);
          autoPlayInterval = null;
        }
        document.getElementById("autoBtn").textContent = "üîÑ Auto Play";
        if (!found) {
          document.getElementById("stepBtn").disabled = false;
        }
      }

      function reset() {
        stopAuto();
        found = false;
        phase = 0;
        subStep = 0;
        countA = 0;
        countB = 0;
        pointerA = 0;
        pointerB = 0;
        stepsToAdvance = 0;

        // Clear all node states
        document.querySelectorAll(".node").forEach((node) => {
          node.classList.remove(
            "counting",
            "skipped",
            "pointer-a",
            "pointer-b",
            "pointer-both",
            "found"
          );
        });

        document
          .querySelectorAll(".code-line")
          .forEach((line) => line.classList.remove("active"));
        document
          .querySelectorAll(".length-box")
          .forEach((box) => box.classList.remove("active"));

        document.getElementById("startBtn").disabled = false;
        document.getElementById("stepBtn").disabled = true;
        document.getElementById("autoBtn").disabled = true;

        document.getElementById("phaseDisplay").textContent = "‚Äî";
        document.getElementById("pointerADisplay").textContent = "‚Äî";
        document.getElementById("pointerBDisplay").textContent = "‚Äî";
        document.getElementById("stepsToGoDisplay").textContent = "‚Äî";
        document.getElementById("statusDisplay").textContent = "Ready";

        document.getElementById("lengthAValue").textContent = "?";
        document.getElementById("lengthBValue").textContent = "?";
        document.getElementById("diffValue").textContent = "?";

        document.getElementById("listAInfo").textContent = "Length: ?";
        document.getElementById("listBInfo").textContent = "Length: ?";

        document.getElementById("formulaDisplay").innerHTML =
          'After alignment, both pointers are <span class="highlight">equidistant</span> from the intersection (or end)!';

        document.getElementById("resultBanner").className = "result-banner";
        document.getElementById("resultBanner").style.display = "none";

        updatePhaseIndicator();

        setExplanation(
          "Click 'Start' to begin. We'll first count both list lengths, then advance the pointer on the longer list by the difference, and finally walk both pointers together until they meet!"
        );

        isRunning = false;
      }
    </script>
  </body>
</html>
