<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Odd-Even Linked List - Optimal In-Place Pointer Manipulation</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Patrick+Hand&family=Kalam:wght@300;400;700&family=Permanent+Marker&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Kalam", cursive;
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* Dark chalkboard background */
      .chalkboard {
        background: linear-gradient(
          135deg,
          #1a1a2e 0%,
          #16213e 50%,
          #0f3460 100%
        );
        min-height: 100vh;
        padding: 25px;
        position: relative;
        overflow: hidden;
      }

      /* Chalk dust texture */
      .chalkboard::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
        pointer-events: none;
      }

      /* Wooden frame */
      .chalkboard::after {
        content: "";
        position: absolute;
        top: 8px;
        left: 8px;
        right: 8px;
        bottom: 8px;
        border: 12px solid #8b4513;
        border-radius: 4px;
        box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.5),
          0 0 20px rgba(0, 0, 0, 0.5);
        pointer-events: none;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 30px 40px 100px;
        position: relative;
        z-index: 1;
      }

      /* Chalk-style title */
      .title {
        font-family: "Permanent Marker", cursive;
        font-size: 2.8rem;
        color: #fff;
        text-align: center;
        margin-bottom: 5px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        letter-spacing: 2px;
      }

      .subtitle {
        font-family: "Caveat", cursive;
        font-size: 1.6rem;
        color: #00ff88;
        text-align: center;
        margin-bottom: 8px;
        text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
      }

      .optimal-badge {
        display: inline-block;
        background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
        color: #1a1a2e;
        padding: 5px 20px;
        border-radius: 20px;
        font-family: "Patrick Hand", cursive;
        font-size: 1.1rem;
        font-weight: bold;
        margin: 10px auto 25px;
        display: block;
        width: fit-content;
        box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
      }

      /* Chalk divider */
      .chalk-divider {
        height: 3px;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.6),
          transparent
        );
        margin: 20px 0;
        border-radius: 2px;
      }

      /* Key concept box */
      .concept-box {
        background: rgba(255, 255, 255, 0.1);
        border: 3px solid #ffd700;
        border-radius: 12px;
        padding: 18px 22px;
        margin-bottom: 25px;
        position: relative;
        backdrop-filter: blur(5px);
      }

      .concept-box::before {
        content: "‚≠ê";
        position: absolute;
        top: -12px;
        left: 15px;
        font-size: 1.3rem;
        background: #1a1a2e;
        padding: 0 8px;
      }

      .concept-box h3 {
        font-family: "Caveat", cursive;
        font-size: 1.5rem;
        color: #ffd700;
        margin-bottom: 10px;
      }

      .concept-box p {
        font-size: 1.05rem;
        color: #e0e0e0;
        line-height: 1.6;
      }

      .concept-box .key-point {
        background: rgba(0, 255, 136, 0.2);
        color: #00ff88;
        padding: 3px 10px;
        border-radius: 5px;
        font-weight: bold;
      }

      /* Pointers legend */
      .pointers-legend {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .pointer-legend-item {
        display: flex;
        align-items: center;
        gap: 10px;
        font-family: "Patrick Hand", cursive;
        font-size: 1.1rem;
        color: #fff;
      }

      .pointer-indicator {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
        font-weight: bold;
        color: #1a1a2e;
      }

      .pointer-indicator.odd-ptr {
        background: #00ff88;
      }
      .pointer-indicator.even-ptr {
        background: #ff6b6b;
      }
      .pointer-indicator.even-head {
        background: #ffd700;
      }

      /* Controls section */
      .controls-section {
        background: rgba(255, 255, 255, 0.08);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        padding: 18px;
        margin-bottom: 20px;
      }

      .step-counter {
        text-align: center;
        font-family: "Patrick Hand", cursive;
        font-size: 1.2rem;
        color: #aaa;
        margin-bottom: 10px;
      }

      .progress-bar {
        width: 100%;
        height: 10px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 5px;
        margin-bottom: 15px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #00ff88, #00cc6a);
        border-radius: 5px;
        transition: width 0.3s ease;
        box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 12px;
        flex-wrap: wrap;
      }

      .btn {
        font-family: "Patrick Hand", cursive;
        font-size: 1.15rem;
        padding: 10px 22px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      .btn:hover:not(:disabled) {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
      }

      .btn:active:not(:disabled) {
        transform: translateY(0);
      }

      .btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-success {
        background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
        color: #1a1a2e;
      }

      .btn-danger {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);
        color: white;
      }

      .btn-warning {
        background: linear-gradient(135deg, #ffd700 0%, #ffb700 100%);
        color: #1a1a2e;
      }

      /* Step explanation */
      .step-explanation {
        background: rgba(102, 126, 234, 0.15);
        border: 3px solid #667eea;
        border-radius: 12px;
        padding: 18px 22px;
        margin-bottom: 20px;
        position: relative;
      }

      .step-explanation::before {
        content: "üìù";
        position: absolute;
        top: -12px;
        right: 15px;
        font-size: 1.3rem;
      }

      .step-explanation h4 {
        font-family: "Caveat", cursive;
        font-size: 1.6rem;
        color: #a8b5ff;
        margin-bottom: 10px;
      }

      .step-explanation p {
        font-size: 1.05rem;
        color: #e0e0e0;
        line-height: 1.6;
      }

      .highlight {
        background: rgba(255, 215, 0, 0.3);
        color: #ffd700;
        padding: 2px 8px;
        border-radius: 4px;
      }

      .code-text {
        font-family: "Fira Code", "Consolas", monospace;
        background: rgba(0, 0, 0, 0.4);
        color: #00ff88;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.95rem;
      }

      /* Pointer state display */
      .pointer-state {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
        margin: 15px 0;
        padding: 15px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        border: 2px solid rgba(255, 255, 255, 0.1);
      }

      .ptr-box {
        text-align: center;
        min-width: 100px;
      }

      .ptr-name {
        font-family: "Fira Code", monospace;
        font-size: 0.9rem;
        margin-bottom: 5px;
      }

      .ptr-name.odd-name {
        color: #00ff88;
      }
      .ptr-name.even-name {
        color: #ff6b6b;
      }
      .ptr-name.evenhead-name {
        color: #ffd700;
      }

      .ptr-value {
        font-family: "Caveat", cursive;
        font-size: 1.4rem;
        font-weight: 700;
        color: #fff;
        background: rgba(255, 255, 255, 0.1);
        padding: 5px 15px;
        border-radius: 8px;
        border: 2px solid rgba(255, 255, 255, 0.2);
      }

      /* Main visualization */
      .viz-section {
        background: rgba(255, 255, 255, 0.05);
        border: 3px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .viz-title {
        font-family: "Caveat", cursive;
        font-size: 1.5rem;
        color: #fff;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
        border-bottom: 2px dashed rgba(255, 255, 255, 0.2);
        padding-bottom: 10px;
      }

      .viz-title .phase-tag {
        background: #667eea;
        color: white;
        padding: 4px 12px;
        border-radius: 15px;
        font-size: 0.9rem;
        font-family: "Patrick Hand", cursive;
      }

      /* Linked list visualization - enhanced */
      .list-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 30px;
        padding: 20px;
      }

      .list-row {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: 5px;
      }

      .node-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
      }

      .node-box {
        width: 60px;
        height: 60px;
        border: 4px solid rgba(255, 255, 255, 0.5);
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-family: "Caveat", cursive;
        font-size: 1.8rem;
        font-weight: 700;
        color: #fff;
        position: relative;
        transition: all 0.3s ease;
        background: rgba(255, 255, 255, 0.1);
      }

      .node-box.odd {
        background: linear-gradient(
          135deg,
          rgba(0, 255, 136, 0.3) 0%,
          rgba(0, 204, 106, 0.3) 100%
        );
        border-color: #00ff88;
        box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
      }

      .node-box.even {
        background: linear-gradient(
          135deg,
          rgba(255, 107, 107, 0.3) 0%,
          rgba(238, 90, 90, 0.3) 100%
        );
        border-color: #ff6b6b;
        box-shadow: 0 0 15px rgba(255, 107, 107, 0.3);
      }

      .node-box.highlight {
        transform: scale(1.2);
        box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
        border-color: #ffd700;
        z-index: 10;
      }

      .node-index {
        position: absolute;
        top: -25px;
        font-family: "Patrick Hand", cursive;
        font-size: 0.85rem;
        color: rgba(255, 255, 255, 0.7);
        background: rgba(0, 0, 0, 0.4);
        padding: 2px 8px;
        border-radius: 4px;
      }

      /* Pointer labels under nodes */
      .pointer-labels {
        display: flex;
        gap: 5px;
        margin-top: 8px;
        min-height: 28px;
      }

      .ptr-label {
        font-family: "Patrick Hand", cursive;
        font-size: 0.85rem;
        padding: 3px 8px;
        border-radius: 10px;
        font-weight: bold;
      }

      .ptr-label.odd-label {
        background: #00ff88;
        color: #1a1a2e;
      }

      .ptr-label.even-label {
        background: #ff6b6b;
        color: #fff;
      }

      .ptr-label.evenhead-label {
        background: #ffd700;
        color: #1a1a2e;
      }

      /* Arrows */
      .arrow {
        font-size: 1.6rem;
        color: rgba(255, 255, 255, 0.6);
        margin: 0 3px;
        transition: all 0.3s ease;
      }

      .arrow.active {
        color: #00ff88;
        text-shadow: 0 0 10px rgba(0, 255, 136, 0.8);
      }

      .arrow.breaking {
        color: #ff6b6b;
        opacity: 0.4;
      }

      .arrow.new-connection {
        color: #ffd700;
        text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        animation: pulse 0.5s ease-in-out;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.3);
        }
      }

      .null-box {
        font-family: "Kalam", cursive;
        font-size: 1rem;
        color: rgba(255, 255, 255, 0.5);
        padding: 8px 15px;
        border: 2px dashed rgba(255, 255, 255, 0.3);
        border-radius: 8px;
      }

      /* Two chains visualization */
      .chains-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 20px;
      }

      .chain-box {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 12px;
        padding: 15px;
        border: 2px solid rgba(255, 255, 255, 0.1);
      }

      .chain-title {
        font-family: "Caveat", cursive;
        font-size: 1.3rem;
        margin-bottom: 10px;
        text-align: center;
      }

      .chain-title.odd-chain {
        color: #00ff88;
      }
      .chain-title.even-chain {
        color: #ff6b6b;
      }

      .chain-nodes {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
        min-height: 50px;
      }

      .mini-node {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Caveat", cursive;
        font-size: 1.4rem;
        font-weight: bold;
        color: #fff;
      }

      .mini-node.odd {
        background: linear-gradient(
          135deg,
          rgba(0, 255, 136, 0.4) 0%,
          rgba(0, 204, 106, 0.4) 100%
        );
        border: 2px solid #00ff88;
      }

      .mini-node.even {
        background: linear-gradient(
          135deg,
          rgba(255, 107, 107, 0.4) 0%,
          rgba(238, 90, 90, 0.4) 100%
        );
        border: 2px solid #ff6b6b;
      }

      .mini-arrow {
        color: rgba(255, 255, 255, 0.5);
        font-size: 1.2rem;
      }

      .empty-chain {
        color: rgba(255, 255, 255, 0.4);
        font-style: italic;
        font-family: "Patrick Hand", cursive;
      }

      /* Final result section */
      .result-section {
        background: linear-gradient(
          135deg,
          rgba(0, 255, 136, 0.1) 0%,
          rgba(0, 204, 106, 0.1) 100%
        );
        border: 3px solid #00ff88;
        box-shadow: 0 0 30px rgba(0, 255, 136, 0.2);
      }

      /* Code section */
      .code-section {
        background: #0d1117;
        border: 3px solid #30363d;
        border-radius: 12px;
        padding: 18px;
        margin: 20px 0;
        overflow-x: auto;
      }

      .code-section pre {
        font-family: "Fira Code", "Consolas", monospace;
        font-size: 0.88rem;
        color: #c9d1d9;
        line-height: 1.5;
        margin: 0;
      }

      .code-section .keyword {
        color: #ff7b72;
      }
      .code-section .string {
        color: #a5d6ff;
      }
      .code-section .number {
        color: #79c0ff;
      }
      .code-section .comment {
        color: #8b949e;
      }
      .code-section .function {
        color: #d2a8ff;
      }
      .code-section .variable {
        color: #ffa657;
      }
      .code-section .highlight-line {
        background: rgba(255, 215, 0, 0.15);
        display: block;
        margin: 0 -18px;
        padding: 0 18px;
        border-left: 3px solid #ffd700;
      }

      /* Complexity section */
      .complexity-section {
        background: linear-gradient(
          135deg,
          rgba(0, 255, 136, 0.15) 0%,
          rgba(0, 204, 106, 0.1) 100%
        );
        border: 3px solid #00ff88;
        border-radius: 12px;
        padding: 20px;
        margin-top: 20px;
      }

      .complexity-section h4 {
        font-family: "Caveat", cursive;
        font-size: 1.6rem;
        color: #00ff88;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .complexity-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
      }

      .complexity-item {
        background: rgba(0, 0, 0, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        padding: 15px;
        text-align: center;
      }

      .complexity-label {
        font-family: "Patrick Hand", cursive;
        font-size: 1rem;
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 5px;
      }

      .complexity-value {
        font-family: "Caveat", cursive;
        font-size: 2rem;
        font-weight: 700;
        color: #00ff88;
      }

      .complexity-value.optimal {
        text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      }

      /* Invariant box */
      .invariant-box {
        background: rgba(255, 215, 0, 0.1);
        border: 2px solid #ffd700;
        border-radius: 10px;
        padding: 15px;
        margin-top: 20px;
      }

      .invariant-box h5 {
        font-family: "Caveat", cursive;
        font-size: 1.3rem;
        color: #ffd700;
        margin-bottom: 10px;
      }

      .invariant-box ul {
        list-style: none;
        padding: 0;
      }

      .invariant-box li {
        font-family: "Patrick Hand", cursive;
        font-size: 1rem;
        color: #e0e0e0;
        padding: 5px 0;
        padding-left: 25px;
        position: relative;
      }

      .invariant-box li::before {
        content: "‚úì";
        position: absolute;
        left: 0;
        color: #00ff88;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .title {
          font-size: 2rem;
        }
        .chains-container {
          grid-template-columns: 1fr;
        }
        .complexity-grid {
          grid-template-columns: 1fr;
        }
        .container {
          padding: 20px 15px 80px;
        }
      }

      /* Animation for nodes */
      @keyframes nodeAppear {
        from {
          opacity: 0;
          transform: scale(0.5);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .node-wrapper {
        animation: nodeAppear 0.4s ease-out forwards;
      }
    </style>
  </head>
  <body>
    <div class="chalkboard">
      <div class="container">
        <!-- Title -->
        <h1 class="title">Odd-Even Linked List</h1>
        <p class="subtitle">
          ‚ú® Optimal Solution: In-Place Pointer Manipulation ‚ú®
        </p>
        <div class="optimal-badge">
          üèÜ O(n) Time | O(1) Space ‚Äî Best Possible!
        </div>

        <!-- Key Concept -->
        <div class="concept-box">
          <h3>üîë The Key Insight</h3>
          <p>
            Instead of storing nodes in arrays, we build
            <span class="key-point">two virtual chains simultaneously</span>
            using just <strong>3 pointers</strong>: <code>odd</code>,
            <code>even</code>, and <code>evenHead</code>. We weave through the
            list, relinking nodes on-the-fly, then connect the chains at the
            end!
          </p>
        </div>

        <!-- Pointer Legend -->
        <div class="pointers-legend">
          <div class="pointer-legend-item">
            <div class="pointer-indicator odd-ptr">odd</div>
            <span>Current tail of odd chain</span>
          </div>
          <div class="pointer-legend-item">
            <div class="pointer-indicator even-ptr">even</div>
            <span>Current tail of even chain</span>
          </div>
          <div class="pointer-legend-item">
            <div class="pointer-indicator even-head">eH</div>
            <span>evenHead (saved start of even chain)</span>
          </div>
        </div>

        <!-- Controls -->
        <div class="controls-section">
          <div class="step-counter">
            Step <span id="currentStep">0</span> of
            <span id="totalSteps">10</span>
          </div>
          <div class="progress-bar">
            <div
              class="progress-fill"
              id="progressFill"
              style="width: 0%"
            ></div>
          </div>
          <div class="controls">
            <button class="btn btn-danger" id="resetBtn">üîÑ Reset</button>
            <button class="btn btn-primary" id="prevBtn" disabled>
              ‚¨Ö Prev
            </button>
            <button class="btn btn-success" id="nextBtn">Next ‚û°</button>
            <button class="btn btn-warning" id="autoBtn">‚ñ∂ Auto</button>
          </div>
        </div>

        <!-- Step Explanation -->
        <div class="step-explanation">
          <h4 id="stepTitle">üöÄ Ready to Begin!</h4>
          <p id="stepDesc">
            Click "Next" to see how we rearrange the list using only 3 pointers
            and O(1) extra space. Watch the magic of in-place pointer
            manipulation!
          </p>
        </div>

        <!-- Pointer State -->
        <div class="pointer-state">
          <div class="ptr-box">
            <div class="ptr-name odd-name">odd</div>
            <div class="ptr-value" id="ptrOdd">‚Äî</div>
          </div>
          <div class="ptr-box">
            <div class="ptr-name even-name">even</div>
            <div class="ptr-value" id="ptrEven">‚Äî</div>
          </div>
          <div class="ptr-box">
            <div class="ptr-name evenhead-name">evenHead</div>
            <div class="ptr-value" id="ptrEvenHead">‚Äî</div>
          </div>
          <div class="ptr-box">
            <div class="ptr-name" style="color: #a8b5ff">iteration</div>
            <div class="ptr-value" id="ptrIteration">‚Äî</div>
          </div>
        </div>

        <!-- Main Visualization -->
        <div class="viz-section">
          <div class="viz-title">
            <span class="phase-tag">Live View</span>
            Current List State (Pointers Shown Below Nodes)
          </div>
          <div class="list-container">
            <div class="list-row" id="mainList"></div>
          </div>

          <!-- Two chains view -->
          <div class="chains-container">
            <div class="chain-box">
              <div class="chain-title odd-chain">
                üü¢ Odd Chain (being built)
              </div>
              <div class="chain-nodes" id="oddChain">
                <span class="empty-chain">waiting...</span>
              </div>
            </div>
            <div class="chain-box">
              <div class="chain-title even-chain">
                üî¥ Even Chain (being built)
              </div>
              <div class="chain-nodes" id="evenChain">
                <span class="empty-chain">waiting...</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Result Section -->
        <div
          class="viz-section result-section"
          id="resultSection"
          style="display: none"
        >
          <div class="viz-title">
            <span class="phase-tag">üéâ Final Result</span>
            Connected: Odd Chain ‚Üí Even Chain
          </div>
          <div class="list-container">
            <div class="list-row" id="resultList"></div>
          </div>
        </div>

        <!-- Code Display -->
        <div class="code-section">
          <pre id="codeDisplay">
<span class="keyword">function</span> <span class="function">oddEvenList</span>(<span class="variable">head</span>) {
    <span class="keyword">if</span> (!<span class="variable">head</span> || !<span class="variable">head</span>.<span class="variable">next</span>) <span class="keyword">return</span> <span class="variable">head</span>;
    
    <span class="keyword">let</span> <span class="variable">odd</span> = <span class="variable">head</span>;              <span class="comment">// Tail of odd chain</span>
    <span class="keyword">let</span> <span class="variable">even</span> = <span class="variable">head</span>.<span class="variable">next</span>;        <span class="comment">// Tail of even chain</span>
    <span class="keyword">const</span> <span class="variable">evenHead</span> = <span class="variable">even</span>;       <span class="comment">// Save start of even chain!</span>
    
    <span class="keyword">while</span> (<span class="variable">even</span> && <span class="variable">even</span>.<span class="variable">next</span>) {
        <span class="variable">odd</span>.<span class="variable">next</span> = <span class="variable">even</span>.<span class="variable">next</span>;    <span class="comment">// Link odd to next odd</span>
        <span class="variable">odd</span> = <span class="variable">odd</span>.<span class="variable">next</span>;           <span class="comment">// Advance odd pointer</span>
        
        <span class="variable">even</span>.<span class="variable">next</span> = <span class="variable">odd</span>.<span class="variable">next</span>;   <span class="comment">// Link even to next even</span>
        <span class="variable">even</span> = <span class="variable">even</span>.<span class="variable">next</span>;        <span class="comment">// Advance even pointer</span>
    }
    
    <span class="variable">odd</span>.<span class="variable">next</span> = <span class="variable">evenHead</span>;        <span class="comment">// Connect odd chain to even chain</span>
    <span class="keyword">return</span> <span class="variable">head</span>;
}</pre>
        </div>

        <!-- Complexity -->
        <div class="complexity-section">
          <h4>üèÜ Optimal Complexity Achieved!</h4>
          <div class="complexity-grid">
            <div class="complexity-item">
              <div class="complexity-label">Time Complexity</div>
              <div class="complexity-value optimal">O(n) ‚úì</div>
            </div>
            <div class="complexity-item">
              <div class="complexity-label">Space Complexity</div>
              <div class="complexity-value optimal">O(1) ‚úì</div>
            </div>
          </div>

          <!-- Loop Invariant -->
          <div class="invariant-box">
            <h5>üìê Loop Invariant (Why It Works)</h5>
            <ul>
              <li>
                <code>odd</code> always points to the last node in the odd chain
              </li>
              <li>
                <code>even</code> always points to the last node in the even
                chain
              </li>
              <li>
                <code>evenHead</code> never changes ‚Äî it's our bridge to connect
                chains
              </li>
              <li>
                Each iteration processes exactly 2 nodes (one odd, one even)
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      // State
      let currentStep = 0;
      let autoPlayInterval = null;

      // Original list
      const listValues = [1, 2, 3, 4, 5];

      // Step definitions
      const steps = [
        {
          title: "üöÄ Initial Setup",
          desc: "We have list [1] ‚Üí [2] ‚Üí [3] ‚Üí [4] ‚Üí [5]. Initialize: <span class='code-text'>odd = head (node 1)</span>, <span class='code-text'>even = head.next (node 2)</span>, and crucially <span class='code-text'>evenHead = even</span> to remember where the even chain starts!",
          odd: 0,
          even: 1,
          evenHead: 1,
          iteration: 0,
          oddChain: [0],
          evenChain: [1],
          links: [
            [0, 1],
            [1, 2],
            [2, 3],
            [3, 4],
          ],
          showResult: false,
        },
        {
          title: "üîÑ Iteration 1: odd.next = even.next",
          desc: "First operation: <span class='code-text'>odd.next = even.next</span> means node1.next = node3. We're making node 1 <span class='highlight'>skip over</span> node 2 and point directly to node 3!",
          odd: 0,
          even: 1,
          evenHead: 1,
          iteration: 1,
          oddChain: [0],
          evenChain: [1],
          links: [
            [0, 2],
            [1, 2],
            [2, 3],
            [3, 4],
          ], // 0‚Üí2 now
          highlightLink: [0, 2],
          showResult: false,
        },
        {
          title: "üîÑ Iteration 1: odd = odd.next",
          desc: "Advance the odd pointer: <span class='code-text'>odd = odd.next</span>. Now <span class='highlight'>odd points to node 3</span>. The odd chain so far: 1 ‚Üí 3",
          odd: 2,
          even: 1,
          evenHead: 1,
          iteration: 1,
          oddChain: [0, 2],
          evenChain: [1],
          links: [
            [0, 2],
            [1, 2],
            [2, 3],
            [3, 4],
          ],
          showResult: false,
        },
        {
          title: "üîÑ Iteration 1: even.next = odd.next",
          desc: "Now update the even chain: <span class='code-text'>even.next = odd.next</span> means node2.next = node4. Node 2 now <span class='highlight'>skips over</span> node 3 and points to node 4!",
          odd: 2,
          even: 1,
          evenHead: 1,
          iteration: 1,
          oddChain: [0, 2],
          evenChain: [1],
          links: [
            [0, 2],
            [1, 3],
            [2, 3],
            [3, 4],
          ], // 1‚Üí3 now
          highlightLink: [1, 3],
          showResult: false,
        },
        {
          title: "üîÑ Iteration 1: even = even.next",
          desc: "Advance the even pointer: <span class='code-text'>even = even.next</span>. Now <span class='highlight'>even points to node 4</span>. Even chain so far: 2 ‚Üí 4. End of iteration 1!",
          odd: 2,
          even: 3,
          evenHead: 1,
          iteration: 1,
          oddChain: [0, 2],
          evenChain: [1, 3],
          links: [
            [0, 2],
            [1, 3],
            [2, 3],
            [3, 4],
          ],
          showResult: false,
        },
        {
          title: "üîÑ Iteration 2: odd.next = even.next",
          desc: "Loop continues (even=node4, even.next=node5 exist). <span class='code-text'>odd.next = even.next</span> means node3.next = node5. Node 3 now points to node 5!",
          odd: 2,
          even: 3,
          evenHead: 1,
          iteration: 2,
          oddChain: [0, 2],
          evenChain: [1, 3],
          links: [
            [0, 2],
            [1, 3],
            [2, 4],
            [3, 4],
          ], // 2‚Üí4 now
          highlightLink: [2, 4],
          showResult: false,
        },
        {
          title: "üîÑ Iteration 2: odd = odd.next",
          desc: "Advance odd: <span class='code-text'>odd = odd.next</span>. Now <span class='highlight'>odd points to node 5</span>. Odd chain complete: 1 ‚Üí 3 ‚Üí 5",
          odd: 4,
          even: 3,
          evenHead: 1,
          iteration: 2,
          oddChain: [0, 2, 4],
          evenChain: [1, 3],
          links: [
            [0, 2],
            [1, 3],
            [2, 4],
            [3, 4],
          ],
          showResult: false,
        },
        {
          title: "üîÑ Iteration 2: even.next = odd.next",
          desc: "<span class='code-text'>even.next = odd.next</span> means node4.next = null (since node5.next is null). This properly <span class='highlight'>terminates the even chain</span>!",
          odd: 4,
          even: 3,
          evenHead: 1,
          iteration: 2,
          oddChain: [0, 2, 4],
          evenChain: [1, 3],
          links: [
            [0, 2],
            [1, 3],
            [2, 4],
          ], // 3‚Üínull now
          highlightLink: [3, -1],
          showResult: false,
        },
        {
          title: "üîÑ Iteration 2: even = even.next ‚Üí Loop Ends",
          desc: "<span class='code-text'>even = even.next</span> makes even = null. Loop condition <span class='code-text'>even && even.next</span> is now <span class='highlight'>false</span>, so we exit the loop!",
          odd: 4,
          even: -1,
          evenHead: 1,
          iteration: 2,
          oddChain: [0, 2, 4],
          evenChain: [1, 3],
          links: [
            [0, 2],
            [1, 3],
            [2, 4],
          ],
          showResult: false,
        },
        {
          title: "üîó Final Step: odd.next = evenHead",
          desc: "The magic finale! <span class='code-text'>odd.next = evenHead</span> means node5.next = node2. This <span class='highlight'>bridges the two chains</span>: odd chain connects to even chain!",
          odd: 4,
          even: -1,
          evenHead: 1,
          iteration: "done",
          oddChain: [0, 2, 4],
          evenChain: [1, 3],
          links: [
            [0, 2],
            [2, 4],
            [4, 1],
            [1, 3],
          ], // 4‚Üí1 connects chains
          highlightLink: [4, 1],
          showResult: false,
        },
        {
          title: "üéâ Algorithm Complete!",
          desc: "Success! Final list: <span class='highlight'>[1] ‚Üí [3] ‚Üí [5] ‚Üí [2] ‚Üí [4] ‚Üí null</span>. All odd-indexed nodes first, then all even-indexed nodes. Done with just <strong>3 pointers</strong> and <strong>O(1) space</strong>!",
          odd: 4,
          even: -1,
          evenHead: 1,
          iteration: "‚úì",
          oddChain: [0, 2, 4],
          evenChain: [1, 3],
          links: [
            [0, 2],
            [2, 4],
            [4, 1],
            [1, 3],
          ],
          showResult: true,
        },
      ];

      // DOM elements
      const mainListEl = document.getElementById("mainList");
      const oddChainEl = document.getElementById("oddChain");
      const evenChainEl = document.getElementById("evenChain");
      const resultListEl = document.getElementById("resultList");
      const resultSectionEl = document.getElementById("resultSection");
      const stepTitleEl = document.getElementById("stepTitle");
      const stepDescEl = document.getElementById("stepDesc");
      const ptrOddEl = document.getElementById("ptrOdd");
      const ptrEvenEl = document.getElementById("ptrEven");
      const ptrEvenHeadEl = document.getElementById("ptrEvenHead");
      const ptrIterationEl = document.getElementById("ptrIteration");
      const progressFillEl = document.getElementById("progressFill");
      const currentStepEl = document.getElementById("currentStep");
      const totalStepsEl = document.getElementById("totalSteps");
      const nextBtn = document.getElementById("nextBtn");
      const prevBtn = document.getElementById("prevBtn");
      const resetBtn = document.getElementById("resetBtn");
      const autoBtn = document.getElementById("autoBtn");

      // Initialize
      totalStepsEl.textContent = steps.length - 1;
      renderStep(0);

      // Render main list with pointers
      function renderMainList(step) {
        mainListEl.innerHTML = "";

        // Build link map from step.links
        const linkMap = {};
        step.links.forEach(([from, to]) => {
          linkMap[from] = to;
        });

        // Determine order based on current links (follow from node 0)
        const order = [];
        const visited = new Set();
        let current = 0;
        while (
          current !== undefined &&
          current !== -1 &&
          !visited.has(current)
        ) {
          order.push(current);
          visited.add(current);
          current = linkMap[current];
        }

        // Add any unvisited nodes
        for (let i = 0; i < listValues.length; i++) {
          if (!visited.has(i)) order.push(i);
        }

        order.forEach((nodeIdx, displayIdx) => {
          const wrapper = document.createElement("div");
          wrapper.className = "node-wrapper";
          wrapper.style.animationDelay = `${displayIdx * 0.1}s`;

          const isOdd = (nodeIdx + 1) % 2 === 1;
          const nodeClass = isOdd ? "odd" : "even";
          const isHighlighted = nodeIdx === step.odd || nodeIdx === step.even;
          const highlightClass = isHighlighted ? "highlight" : "";

          // Pointer labels
          let labels = [];
          if (nodeIdx === step.odd)
            labels.push('<span class="ptr-label odd-label">odd</span>');
          if (nodeIdx === step.even)
            labels.push('<span class="ptr-label even-label">even</span>');
          if (nodeIdx === step.evenHead)
            labels.push('<span class="ptr-label evenhead-label">eH</span>');

          // Arrow
          let arrow = "";
          const nextNode = linkMap[nodeIdx];
          if (nextNode !== undefined && nextNode !== -1) {
            let arrowClass = "";
            if (step.highlightLink && step.highlightLink[0] === nodeIdx) {
              arrowClass = "new-connection";
            }
            arrow = `<span class="arrow ${arrowClass}">‚Üí</span>`;
          } else if (displayIdx === order.length - 1 || nextNode === -1) {
            arrow = `<span class="arrow">‚Üí</span><span class="null-box">null</span>`;
          }

          wrapper.innerHTML = `
                    <div class="node-box ${nodeClass} ${highlightClass}">
                        <span class="node-index">idx ${nodeIdx + 1}</span>
                        ${listValues[nodeIdx]}
                    </div>
                    <div class="pointer-labels">${labels.join("")}</div>
                `;

          mainListEl.appendChild(wrapper);

          // Add arrow after node (except last)
          if (arrow && displayIdx < order.length - 1) {
            const arrowSpan = document.createElement("span");
            arrowSpan.innerHTML = arrow;
            mainListEl.appendChild(arrowSpan);
          } else if (nextNode === undefined || nextNode === -1) {
            const arrowSpan = document.createElement("span");
            arrowSpan.innerHTML = `<span class="arrow">‚Üí</span><span class="null-box">null</span>`;
            mainListEl.appendChild(arrowSpan);
          }
        });
      }

      // Render chain
      function renderChain(container, nodeIndices, type) {
        if (nodeIndices.length === 0) {
          container.innerHTML = '<span class="empty-chain">waiting...</span>';
          return;
        }

        container.innerHTML = "";
        nodeIndices.forEach((idx, i) => {
          const node = document.createElement("div");
          node.className = `mini-node ${type}`;
          node.textContent = listValues[idx];
          container.appendChild(node);

          if (i < nodeIndices.length - 1) {
            const arrow = document.createElement("span");
            arrow.className = "mini-arrow";
            arrow.textContent = "‚Üí";
            container.appendChild(arrow);
          }
        });
      }

      // Render result list
      function renderResultList() {
        resultListEl.innerHTML = "";
        const finalOrder = [0, 2, 4, 1, 3]; // 1,3,5,2,4

        finalOrder.forEach((nodeIdx, i) => {
          const wrapper = document.createElement("div");
          wrapper.className = "node-wrapper";
          wrapper.style.animationDelay = `${i * 0.1}s`;

          const isOdd = (nodeIdx + 1) % 2 === 1;
          const nodeClass = isOdd ? "odd" : "even";

          wrapper.innerHTML = `
                    <div class="node-box ${nodeClass}">
                        ${listValues[nodeIdx]}
                    </div>
                    <div class="pointer-labels"></div>
                `;

          resultListEl.appendChild(wrapper);

          if (i < finalOrder.length - 1) {
            const arrow = document.createElement("span");
            arrow.className = "arrow active";
            arrow.textContent = "‚Üí";
            resultListEl.appendChild(arrow);
          } else {
            const nullSpan = document.createElement("span");
            nullSpan.innerHTML =
              '<span class="arrow">‚Üí</span><span class="null-box">null</span>';
            resultListEl.appendChild(nullSpan);
          }
        });
      }

      // Render step
      function renderStep(stepIdx) {
        const step = steps[stepIdx];

        // Update text
        stepTitleEl.textContent = step.title;
        stepDescEl.innerHTML = step.desc;

        // Update pointers
        ptrOddEl.textContent =
          step.odd >= 0
            ? `node${step.odd + 1} (val=${listValues[step.odd]})`
            : "‚Äî";
        ptrEvenEl.textContent =
          step.even >= 0
            ? `node${step.even + 1} (val=${listValues[step.even]})`
            : "null";
        ptrEvenHeadEl.textContent =
          step.evenHead >= 0
            ? `node${step.evenHead + 1} (val=${listValues[step.evenHead]})`
            : "‚Äî";
        ptrIterationEl.textContent = step.iteration;

        // Render visuals
        renderMainList(step);
        renderChain(oddChainEl, step.oddChain, "odd");
        renderChain(evenChainEl, step.evenChain, "even");

        // Result section
        if (step.showResult) {
          resultSectionEl.style.display = "block";
          renderResultList();
        } else {
          resultSectionEl.style.display = "none";
        }

        // Progress
        const progress = (stepIdx / (steps.length - 1)) * 100;
        progressFillEl.style.width = `${progress}%`;
        currentStepEl.textContent = stepIdx;

        // Buttons
        prevBtn.disabled = stepIdx === 0;
        nextBtn.disabled = stepIdx === steps.length - 1;
      }

      // Event handlers
      nextBtn.addEventListener("click", () => {
        if (currentStep < steps.length - 1) {
          currentStep++;
          renderStep(currentStep);
        }
      });

      prevBtn.addEventListener("click", () => {
        if (currentStep > 0) {
          currentStep--;
          renderStep(currentStep);
        }
      });

      resetBtn.addEventListener("click", () => {
        stopAutoPlay();
        currentStep = 0;
        renderStep(currentStep);
      });

      autoBtn.addEventListener("click", () => {
        if (autoPlayInterval) {
          stopAutoPlay();
        } else {
          startAutoPlay();
        }
      });

      function startAutoPlay() {
        autoBtn.textContent = "‚è∏ Pause";
        autoBtn.classList.remove("btn-warning");
        autoBtn.classList.add("btn-danger");

        autoPlayInterval = setInterval(() => {
          if (currentStep < steps.length - 1) {
            currentStep++;
            renderStep(currentStep);
          } else {
            stopAutoPlay();
          }
        }, 2200);
      }

      function stopAutoPlay() {
        autoBtn.textContent = "‚ñ∂ Auto";
        autoBtn.classList.remove("btn-danger");
        autoBtn.classList.add("btn-warning");

        if (autoPlayInterval) {
          clearInterval(autoPlayInterval);
          autoPlayInterval = null;
        }
      }

      // Keyboard
      document.addEventListener("keydown", (e) => {
        if (e.key === "ArrowRight" && currentStep < steps.length - 1) {
          currentStep++;
          renderStep(currentStep);
        } else if (e.key === "ArrowLeft" && currentStep > 0) {
          currentStep--;
          renderStep(currentStep);
        } else if (e.key === " ") {
          e.preventDefault();
          if (autoPlayInterval) stopAutoPlay();
          else startAutoPlay();
        }
      });
    </script>
  </body>
</html>
