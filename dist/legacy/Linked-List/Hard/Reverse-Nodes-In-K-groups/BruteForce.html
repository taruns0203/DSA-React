<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reverse Nodes in K-Group - Brute Force Approach</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&family=Patrick+Hand&family=Fira+Code:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Patrick Hand", cursive;
        background: #f5f5f0;
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* Whiteboard container */
      .whiteboard {
        max-width: 1200px;
        margin: 0 auto;
        padding: 30px;
        background: #fffef9;
        min-height: 100vh;
        position: relative;
        box-shadow: inset 0 0 100px rgba(0, 0, 0, 0.03),
          0 0 50px rgba(0, 0, 0, 0.1);
      }

      /* Grid lines like a whiteboard */
      .whiteboard::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: linear-gradient(
            rgba(200, 200, 220, 0.15) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgba(200, 200, 220, 0.15) 1px, transparent 1px);
        background-size: 30px 30px;
        pointer-events: none;
      }

      /* Marker smudge effect */
      .whiteboard::after {
        content: "";
        position: absolute;
        top: 20px;
        right: 20px;
        width: 80px;
        height: 40px;
        background: linear-gradient(
          135deg,
          rgba(100, 100, 100, 0.05),
          transparent
        );
        border-radius: 50%;
        pointer-events: none;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
        position: relative;
      }

      .header h1 {
        font-family: "Caveat", cursive;
        font-size: 3rem;
        color: #2c3e50;
        font-weight: 700;
        text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.05);
        letter-spacing: 1px;
      }

      .header .subtitle {
        font-size: 1.4rem;
        color: #e74c3c;
        margin-top: 5px;
        font-family: "Caveat", cursive;
      }

      .header .underline {
        width: 300px;
        height: 4px;
        background: linear-gradient(
          90deg,
          transparent,
          #3498db,
          #e74c3c,
          transparent
        );
        margin: 10px auto;
        border-radius: 2px;
      }

      /* Problem statement box */
      .problem-box {
        background: rgba(52, 152, 219, 0.08);
        border: 3px solid #3498db;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 25px;
        position: relative;
        transform: rotate(-0.3deg);
      }

      .problem-box::before {
        content: "üìã Example";
        position: absolute;
        top: -15px;
        left: 20px;
        background: #fffef9;
        padding: 0 10px;
        font-family: "Caveat", cursive;
        font-size: 1.3rem;
        color: #3498db;
        font-weight: 600;
      }

      .problem-box code {
        font-family: "Fira Code", monospace;
        background: rgba(0, 0, 0, 0.05);
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 1.1rem;
      }

      /* Controls */
      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .btn {
        font-family: "Patrick Hand", cursive;
        font-size: 1.2rem;
        padding: 12px 25px;
        border: 3px solid #2c3e50;
        background: #fff;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.2s ease;
        box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.2);
        position: relative;
      }

      .btn:hover {
        transform: translate(-2px, -2px);
        box-shadow: 5px 5px 0 rgba(0, 0, 0, 0.25);
      }

      .btn:active {
        transform: translate(1px, 1px);
        box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.2);
      }

      .btn.primary {
        background: #3498db;
        color: white;
        border-color: #2980b9;
      }

      .btn.success {
        background: #27ae60;
        color: white;
        border-color: #1e8449;
      }

      .btn.warning {
        background: #f39c12;
        color: white;
        border-color: #d68910;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
        box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.1);
      }

      /* Step indicator */
      .step-indicator {
        text-align: center;
        margin-bottom: 20px;
        font-family: "Caveat", cursive;
        font-size: 1.5rem;
        color: #7f8c8d;
      }

      .step-indicator .current {
        color: #e74c3c;
        font-weight: 700;
        font-size: 1.8rem;
      }

      /* Main visualization area */
      .viz-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 25px;
      }

      .section {
        background: rgba(255, 255, 255, 0.7);
        border: 2px dashed #bdc3c7;
        border-radius: 15px;
        padding: 20px;
        position: relative;
      }

      .section-title {
        font-family: "Caveat", cursive;
        font-size: 1.6rem;
        color: #8e44ad;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .section-title .icon {
        font-size: 1.4rem;
      }

      /* Linked List visualization */
      .linked-list {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
        flex-wrap: wrap;
        min-height: 80px;
      }

      .node {
        width: 60px;
        height: 60px;
        background: linear-gradient(145deg, #fff, #f0f0f0);
        border: 3px solid #2c3e50;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Fira Code", monospace;
        font-size: 1.5rem;
        font-weight: 600;
        color: #2c3e50;
        position: relative;
        transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.15);
      }

      .node.highlight {
        background: linear-gradient(145deg, #ffeaa7, #fdcb6e);
        border-color: #f39c12;
        transform: scale(1.1);
        box-shadow: 5px 5px 0 rgba(243, 156, 18, 0.3);
      }

      .node.collected {
        background: linear-gradient(145deg, #81ecec, #00cec9);
        border-color: #00b894;
      }

      .node.reversed {
        background: linear-gradient(145deg, #a29bfe, #6c5ce7);
        border-color: #5f27cd;
        color: white;
      }

      .node.final {
        background: linear-gradient(145deg, #55efc4, #00b894);
        border-color: #00a86b;
        color: white;
      }

      .arrow {
        font-size: 1.8rem;
        color: #7f8c8d;
        transition: all 0.3s ease;
      }

      .arrow.active {
        color: #e74c3c;
        transform: scale(1.2);
      }

      /* Array visualization */
      .array-viz {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 3px;
        margin: 15px 0;
        flex-wrap: wrap;
      }

      .array-bracket {
        font-family: "Fira Code", monospace;
        font-size: 3rem;
        color: #2c3e50;
        font-weight: 300;
      }

      .array-cell {
        width: 55px;
        height: 55px;
        background: #fff;
        border: 2px solid #34495e;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Fira Code", monospace;
        font-size: 1.3rem;
        font-weight: 600;
        position: relative;
        transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      }

      .array-cell.group-a {
        background: linear-gradient(145deg, #fab1a0, #e17055);
        color: white;
      }

      .array-cell.group-b {
        background: linear-gradient(145deg, #74b9ff, #0984e3);
        color: white;
      }

      .array-cell.incomplete {
        background: linear-gradient(145deg, #dfe6e9, #b2bec3);
      }

      .array-cell.swapping {
        animation: swap-pulse 0.5s ease;
        box-shadow: 0 0 20px rgba(231, 76, 60, 0.6);
      }

      @keyframes swap-pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.15);
        }
      }

      .array-cell .index {
        position: absolute;
        bottom: -22px;
        font-size: 0.75rem;
        color: #7f8c8d;
        font-family: "Fira Code", monospace;
      }

      /* Group brackets */
      .groups-container {
        position: relative;
        padding-bottom: 40px;
      }

      .group-bracket {
        position: absolute;
        bottom: 5px;
        height: 25px;
        border: 2px solid;
        border-top: none;
        border-radius: 0 0 10px 10px;
        display: flex;
        align-items: flex-end;
        justify-content: center;
        font-family: "Caveat", cursive;
        font-size: 1rem;
        padding-bottom: 2px;
      }

      /* Explanation box */
      .explanation {
        background: linear-gradient(135deg, #fffef0, #fff9e6);
        border: 3px solid #f39c12;
        border-radius: 15px;
        padding: 20px;
        margin-top: 20px;
        position: relative;
        transform: rotate(0.2deg);
      }

      .explanation::before {
        content: "üí°";
        position: absolute;
        top: -18px;
        left: 20px;
        font-size: 1.8rem;
        background: #fffef9;
        padding: 0 5px;
      }

      .explanation-text {
        font-size: 1.25rem;
        color: #2c3e50;
        line-height: 1.6;
      }

      .explanation-text .highlight-text {
        background: linear-gradient(180deg, transparent 60%, #ffeaa7 60%);
        padding: 0 3px;
      }

      /* Code section */
      .code-section {
        background: #2d3436;
        border-radius: 12px;
        padding: 20px;
        margin-top: 20px;
        position: relative;
        overflow: hidden;
      }

      .code-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 30px;
        background: #636e72;
        border-radius: 12px 12px 0 0;
      }

      .code-section .dots {
        position: absolute;
        top: 8px;
        left: 12px;
        display: flex;
        gap: 6px;
      }

      .code-section .dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
      }

      .code-section .dot.red {
        background: #ff5f56;
      }
      .code-section .dot.yellow {
        background: #ffbd2e;
      }
      .code-section .dot.green {
        background: #27ca40;
      }

      .code-content {
        margin-top: 20px;
        font-family: "Fira Code", monospace;
        font-size: 0.95rem;
        color: #dfe6e9;
        line-height: 1.7;
        overflow-x: auto;
      }

      .code-line {
        padding: 2px 0;
        transition: all 0.3s ease;
      }

      .code-line.active {
        background: rgba(116, 185, 255, 0.2);
        border-left: 3px solid #74b9ff;
        padding-left: 10px;
        margin-left: -10px;
      }

      .code-keyword {
        color: #fd79a8;
      }
      .code-function {
        color: #74b9ff;
      }
      .code-variable {
        color: #55efc4;
      }
      .code-number {
        color: #ffeaa7;
      }
      .code-comment {
        color: #636e72;
        font-style: italic;
      }

      /* Variable tracker */
      .var-tracker {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 15px;
      }

      .var-box {
        background: #fff;
        border: 2px solid #bdc3c7;
        border-radius: 10px;
        padding: 12px;
        text-align: center;
        transition: all 0.3s ease;
      }

      .var-box.active {
        border-color: #3498db;
        box-shadow: 0 0 15px rgba(52, 152, 219, 0.3);
      }

      .var-name {
        font-family: "Fira Code", monospace;
        font-size: 0.9rem;
        color: #7f8c8d;
        margin-bottom: 5px;
      }

      .var-value {
        font-family: "Fira Code", monospace;
        font-size: 1.2rem;
        color: #2c3e50;
        font-weight: 600;
      }

      /* Progress bar */
      .progress-container {
        margin: 20px 0;
        background: #ecf0f1;
        border-radius: 10px;
        height: 12px;
        overflow: hidden;
        box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #3498db, #9b59b6, #e74c3c);
        border-radius: 10px;
        transition: width 0.5s ease;
      }

      /* Hand-drawn decorations */
      .decoration {
        position: absolute;
        font-family: "Caveat", cursive;
        color: #e74c3c;
        opacity: 0.7;
        pointer-events: none;
      }

      .star {
        font-size: 2rem;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .header h1 {
          font-size: 2rem;
        }

        .node,
        .array-cell {
          width: 45px;
          height: 45px;
          font-size: 1.1rem;
        }

        .controls {
          gap: 10px;
        }

        .btn {
          padding: 10px 18px;
          font-size: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="whiteboard">
      <!-- Header -->
      <div class="header">
        <h1>üîÑ Reverse Nodes in K-Group</h1>
        <div class="subtitle">Brute Force Approach - Array Method</div>
        <div class="underline"></div>
      </div>

      <!-- Problem Box -->
      <div class="problem-box">
        <p style="font-size: 1.2rem; margin-bottom: 10px">
          <strong>Input:</strong> <code>head = [1, 2, 3, 4, 5]</code>,
          <code>k = 2</code>
        </p>
        <p style="font-size: 1.2rem">
          <strong>Expected Output:</strong> <code>[2, 1, 4, 3, 5]</code>
        </p>
      </div>

      <!-- Controls -->
      <div class="controls">
        <button class="btn warning" id="prevBtn" disabled>‚óÄ Previous</button>
        <button class="btn primary" id="nextBtn">Next ‚ñ∂</button>
        <button class="btn" id="autoBtn">‚ñ∂ Auto Play</button>
        <button class="btn success" id="resetBtn">‚Ü∫ Reset</button>
      </div>

      <!-- Progress -->
      <div class="progress-container">
        <div class="progress-bar" id="progressBar" style="width: 0%"></div>
      </div>

      <!-- Step Indicator -->
      <div class="step-indicator">
        Step <span class="current" id="stepNum">0</span> of
        <span id="totalSteps">12</span>
      </div>

      <!-- Visualization Container -->
      <div class="viz-container">
        <!-- Original Linked List -->
        <div class="section">
          <div class="section-title">
            <span class="icon">üîó</span> Original Linked List
          </div>
          <div class="linked-list" id="linkedList">
            <!-- Generated by JS -->
          </div>
        </div>

        <!-- Array Visualization -->
        <div class="section">
          <div class="section-title">
            <span class="icon">üì¶</span> Array (nodes collected)
          </div>
          <div class="groups-container">
            <div class="array-viz" id="arrayViz">
              <span class="array-bracket">[</span>
              <span class="array-bracket">]</span>
            </div>
          </div>
        </div>

        <!-- Variable Tracker -->
        <div class="section">
          <div class="section-title">
            <span class="icon">üìä</span> Variable States
          </div>
          <div class="var-tracker" id="varTracker">
            <div class="var-box" id="var-n">
              <div class="var-name">n (length)</div>
              <div class="var-value">-</div>
            </div>
            <div class="var-box" id="var-k">
              <div class="var-name">k</div>
              <div class="var-value">2</div>
            </div>
            <div class="var-box" id="var-group">
              <div class="var-name">groupStart</div>
              <div class="var-value">-</div>
            </div>
            <div class="var-box" id="var-left">
              <div class="var-name">left</div>
              <div class="var-value">-</div>
            </div>
            <div class="var-box" id="var-right">
              <div class="var-name">right</div>
              <div class="var-value">-</div>
            </div>
          </div>
        </div>

        <!-- Code Section -->
        <div class="code-section">
          <div class="dots">
            <div class="dot red"></div>
            <div class="dot yellow"></div>
            <div class="dot green"></div>
          </div>
          <div class="code-content" id="codeBlock">
            <div class="code-line" data-line="1">
              <span class="code-comment"
                >// Step 1: Collect all nodes into array</span
              >
            </div>
            <div class="code-line" data-line="2">
              <span class="code-keyword">const</span>
              <span class="code-variable">nodes</span> = [];
            </div>
            <div class="code-line" data-line="3">
              <span class="code-keyword">while</span> (current) { nodes.<span
                class="code-function"
                >push</span
              >(current); }
            </div>
            <div class="code-line" data-line="4"></div>
            <div class="code-line" data-line="5">
              <span class="code-comment"
                >// Step 2: Reverse each group of k</span
              >
            </div>
            <div class="code-line" data-line="6">
              <span class="code-keyword">for</span> (<span class="code-variable"
                >groupStart</span
              >
              = <span class="code-number">0</span>; groupStart < n; groupStart
              += k) {
            </div>
            <div class="code-line" data-line="7">
              <span class="code-keyword">if</span> (groupStart + k > n)
              <span class="code-keyword">break</span>;
              <span class="code-comment">// incomplete group</span>
            </div>
            <div class="code-line" data-line="8">
              <span class="code-variable">left</span> = groupStart;
              <span class="code-variable">right</span> = groupStart + k -
              <span class="code-number">1</span>;
            </div>
            <div class="code-line" data-line="9">
              <span class="code-keyword">while</span> (left < right)
              <span class="code-function">swap</span>(nodes[left++],
              nodes[right--]);
            </div>
            <div class="code-line" data-line="10">}</div>
            <div class="code-line" data-line="11"></div>
            <div class="code-line" data-line="12">
              <span class="code-comment"
                >// Step 3: Rebuild linked list from array</span
              >
            </div>
            <div class="code-line" data-line="13">
              <span class="code-keyword">for</span> (i =
              <span class="code-number">0</span>; i < n-<span
                class="code-number"
                >1</span
              >; i++) nodes[i].next = nodes[i+<span class="code-number">1</span
              >];
            </div>
          </div>
        </div>
      </div>

      <!-- Explanation -->
      <div class="explanation">
        <div class="explanation-text" id="explanation">
          Welcome! Click <span class="highlight-text">Next</span> to start the
          step-by-step visualization of the Brute Force approach.
        </div>
      </div>

      <!-- Decorations -->
      <div class="decoration star" style="top: 100px; right: 50px">‚ú¶</div>
      <div class="decoration star" style="bottom: 150px; left: 30px">‚úß</div>
    </div>

    <script>
      // Configuration
      const input = [1, 2, 3, 4, 5];
      const k = 2;
      let currentStep = 0;
      let autoPlayInterval = null;

      // Steps definition
      const steps = [
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [],
            collected: [],
            arrows: [],
          },
          array: { cells: [], groups: [], swapping: [] },
          vars: { n: "-", k: "2", group: "-", left: "-", right: "-" },
          activeLine: null,
          activeVars: [],
          explanation:
            "We start with a linked list: <span class='highlight-text'>1 ‚Üí 2 ‚Üí 3 ‚Üí 4 ‚Üí 5</span> and k = 2. Our goal is to reverse every group of 2 nodes.",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [0],
            collected: [],
            arrows: [0],
          },
          array: { cells: [1], groups: [], swapping: [] },
          vars: { n: "1", k: "2", group: "-", left: "-", right: "-" },
          activeLine: 3,
          activeVars: ["var-n"],
          explanation:
            "üì• <span class='highlight-text'>Step 1: Collect nodes into array.</span> We traverse the linked list and push each node reference into an array. First node (1) collected!",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [1],
            collected: [0],
            arrows: [1],
          },
          array: { cells: [1, 2], groups: [], swapping: [] },
          vars: { n: "2", k: "2", group: "-", left: "-", right: "-" },
          activeLine: 3,
          activeVars: ["var-n"],
          explanation: "üì• Collecting node 2...",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [2],
            collected: [0, 1],
            arrows: [2],
          },
          array: { cells: [1, 2, 3], groups: [], swapping: [] },
          vars: { n: "3", k: "2", group: "-", left: "-", right: "-" },
          activeLine: 3,
          activeVars: ["var-n"],
          explanation: "üì• Collecting node 3...",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [3],
            collected: [0, 1, 2],
            arrows: [3],
          },
          array: { cells: [1, 2, 3, 4], groups: [], swapping: [] },
          vars: { n: "4", k: "2", group: "-", left: "-", right: "-" },
          activeLine: 3,
          activeVars: ["var-n"],
          explanation: "üì• Collecting node 4...",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [4],
            collected: [0, 1, 2, 3],
            arrows: [4],
          },
          array: { cells: [1, 2, 3, 4, 5], groups: [], swapping: [] },
          vars: { n: "5", k: "2", group: "-", left: "-", right: "-" },
          activeLine: 3,
          activeVars: ["var-n"],
          explanation:
            "üì• Collecting node 5... <span class='highlight-text'>All nodes collected!</span> Array = [1, 2, 3, 4, 5], n = 5",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [],
            collected: [0, 1, 2, 3, 4],
            arrows: [],
          },
          array: {
            cells: [1, 2, 3, 4, 5],
            groups: [
              { start: 0, end: 1, color: "a" },
              { start: 2, end: 3, color: "b" },
              { start: 4, end: 4, color: "inc" },
            ],
            swapping: [],
          },
          vars: { n: "5", k: "2", group: "0", left: "0", right: "1" },
          activeLine: 6,
          activeVars: ["var-group", "var-left", "var-right"],
          explanation:
            "üîÑ <span class='highlight-text'>Step 2: Identify groups.</span> Group 1: indices [0,1], Group 2: indices [2,3], Incomplete: index [4]. Now reverse each complete group!",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [],
            collected: [0, 1, 2, 3, 4],
            arrows: [],
          },
          array: {
            cells: [1, 2, 3, 4, 5],
            groups: [{ start: 0, end: 1, color: "a" }],
            swapping: [0, 1],
          },
          vars: { n: "5", k: "2", group: "0", left: "0", right: "1" },
          activeLine: 9,
          activeVars: ["var-left", "var-right"],
          explanation:
            "üîÑ <span class='highlight-text'>Reversing Group 1:</span> Swap nodes[0] and nodes[1]. Swapping 1 ‚Üî 2...",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [],
            collected: [0, 1, 2, 3, 4],
            arrows: [],
          },
          array: {
            cells: [2, 1, 3, 4, 5],
            groups: [{ start: 0, end: 1, color: "a" }],
            swapping: [],
          },
          vars: { n: "5", k: "2", group: "0", left: "1", right: "0" },
          activeLine: 9,
          activeVars: ["var-left", "var-right"],
          explanation:
            "‚úÖ Group 1 reversed! Array is now [<span class='highlight-text'>2, 1</span>, 3, 4, 5]. left (1) >= right (0), so we're done with this group.",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [],
            collected: [0, 1, 2, 3, 4],
            arrows: [],
          },
          array: {
            cells: [2, 1, 3, 4, 5],
            groups: [{ start: 2, end: 3, color: "b" }],
            swapping: [2, 3],
          },
          vars: { n: "5", k: "2", group: "2", left: "2", right: "3" },
          activeLine: 9,
          activeVars: ["var-group", "var-left", "var-right"],
          explanation:
            "üîÑ <span class='highlight-text'>Reversing Group 2:</span> groupStart = 2. Swap nodes[2] and nodes[3]. Swapping 3 ‚Üî 4...",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [],
            collected: [0, 1, 2, 3, 4],
            arrows: [],
          },
          array: {
            cells: [2, 1, 4, 3, 5],
            groups: [{ start: 2, end: 3, color: "b" }],
            swapping: [],
          },
          vars: { n: "5", k: "2", group: "2", left: "3", right: "2" },
          activeLine: 9,
          activeVars: ["var-left", "var-right"],
          explanation:
            "‚úÖ Group 2 reversed! Array is now [2, 1, <span class='highlight-text'>4, 3</span>, 5]. left >= right, group complete.",
        },
        {
          linkedList: {
            nodes: [1, 2, 3, 4, 5],
            highlight: [],
            collected: [0, 1, 2, 3, 4],
            arrows: [],
          },
          array: {
            cells: [2, 1, 4, 3, 5],
            groups: [{ start: 4, end: 4, color: "inc" }],
            swapping: [],
          },
          vars: { n: "5", k: "2", group: "4", left: "-", right: "-" },
          activeLine: 7,
          activeVars: ["var-group"],
          explanation:
            "‚ö†Ô∏è <span class='highlight-text'>Group 3 check:</span> groupStart = 4, but 4 + 2 = 6 > 5 (n). This is an incomplete group! Only 1 node left. We skip this group (no reversal).",
        },
        {
          linkedList: {
            nodes: [2, 1, 4, 3, 5],
            highlight: [],
            collected: [],
            arrows: [0, 1, 2, 3],
            final: true,
          },
          array: {
            cells: [2, 1, 4, 3, 5],
            groups: [],
            swapping: [],
            final: true,
          },
          vars: { n: "5", k: "2", group: "-", left: "-", right: "-" },
          activeLine: 13,
          activeVars: [],
          explanation:
            "üîó <span class='highlight-text'>Step 3: Rebuild linked list.</span> Reconnect nodes in array order: 2 ‚Üí 1 ‚Üí 4 ‚Üí 3 ‚Üí 5 ‚Üí null. <span class='highlight-text'>Done!</span> üéâ",
        },
      ];

      // DOM Elements
      const linkedListEl = document.getElementById("linkedList");
      const arrayVizEl = document.getElementById("arrayViz");
      const explanationEl = document.getElementById("explanation");
      const stepNumEl = document.getElementById("stepNum");
      const totalStepsEl = document.getElementById("totalSteps");
      const progressBar = document.getElementById("progressBar");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const autoBtn = document.getElementById("autoBtn");
      const resetBtn = document.getElementById("resetBtn");
      const codeBlock = document.getElementById("codeBlock");

      // Initialize
      totalStepsEl.textContent = steps.length - 1;
      render();

      // Event Listeners
      prevBtn.addEventListener("click", () => {
        if (currentStep > 0) {
          currentStep--;
          render();
        }
      });

      nextBtn.addEventListener("click", () => {
        if (currentStep < steps.length - 1) {
          currentStep++;
          render();
        }
      });

      autoBtn.addEventListener("click", () => {
        if (autoPlayInterval) {
          clearInterval(autoPlayInterval);
          autoPlayInterval = null;
          autoBtn.textContent = "‚ñ∂ Auto Play";
        } else {
          autoBtn.textContent = "‚è∏ Pause";
          autoPlayInterval = setInterval(() => {
            if (currentStep < steps.length - 1) {
              currentStep++;
              render();
            } else {
              clearInterval(autoPlayInterval);
              autoPlayInterval = null;
              autoBtn.textContent = "‚ñ∂ Auto Play";
            }
          }, 1500);
        }
      });

      resetBtn.addEventListener("click", () => {
        if (autoPlayInterval) {
          clearInterval(autoPlayInterval);
          autoPlayInterval = null;
          autoBtn.textContent = "‚ñ∂ Auto Play";
        }
        currentStep = 0;
        render();
      });

      // Keyboard navigation
      document.addEventListener("keydown", (e) => {
        if (e.key === "ArrowRight" && currentStep < steps.length - 1) {
          currentStep++;
          render();
        } else if (e.key === "ArrowLeft" && currentStep > 0) {
          currentStep--;
          render();
        }
      });

      // Render function
      function render() {
        const step = steps[currentStep];

        // Update step indicator
        stepNumEl.textContent = currentStep;
        progressBar.style.width = `${
          (currentStep / (steps.length - 1)) * 100
        }%`;

        // Update buttons
        prevBtn.disabled = currentStep === 0;
        nextBtn.disabled = currentStep === steps.length - 1;

        // Render linked list
        renderLinkedList(step.linkedList);

        // Render array
        renderArray(step.array);

        // Update variables
        updateVariables(step.vars, step.activeVars);

        // Highlight code line
        highlightCode(step.activeLine);

        // Update explanation
        explanationEl.innerHTML = step.explanation;
      }

      function renderLinkedList(config) {
        const { nodes, highlight, collected, arrows, final } = config;
        let html = "";

        nodes.forEach((val, i) => {
          let classes = "node";
          if (highlight.includes(i)) classes += " highlight";
          if (collected.includes(i)) classes += " collected";
          if (final) classes += " final";

          html += `<div class="${classes}">${val}</div>`;

          if (i < nodes.length - 1) {
            let arrowClass = "arrow";
            if (arrows.includes(i)) arrowClass += " active";
            html += `<span class="${arrowClass}">‚Üí</span>`;
          }
        });

        html +=
          '<span class="arrow">‚Üí</span><span style="color: #95a5a6; font-family: Fira Code;">null</span>';
        linkedListEl.innerHTML = html;
      }

      function renderArray(config) {
        const { cells, groups, swapping, final } = config;

        if (cells.length === 0) {
          arrayVizEl.innerHTML =
            '<span class="array-bracket">[</span><span style="color: #bdc3c7; font-style: italic;">empty</span><span class="array-bracket">]</span>';
          return;
        }

        let html = '<span class="array-bracket">[</span>';

        cells.forEach((val, i) => {
          let classes = "array-cell";

          // Check which group this cell belongs to
          groups.forEach((g) => {
            if (i >= g.start && i <= g.end) {
              if (g.color === "a") classes += " group-a";
              else if (g.color === "b") classes += " group-b";
              else if (g.color === "inc") classes += " incomplete";
            }
          });

          if (swapping.includes(i)) classes += " swapping";
          if (final) classes += " final";

          html += `<div class="${classes}">${val}<span class="index">[${i}]</span></div>`;
        });

        html += '<span class="array-bracket">]</span>';
        arrayVizEl.innerHTML = html;
      }

      function updateVariables(vars, activeVars) {
        Object.keys(vars).forEach((key) => {
          const el = document.getElementById(`var-${key}`);
          if (el) {
            el.querySelector(".var-value").textContent = vars[key];
            if (activeVars.includes(`var-${key}`)) {
              el.classList.add("active");
            } else {
              el.classList.remove("active");
            }
          }
        });
      }

      function highlightCode(lineNum) {
        document.querySelectorAll(".code-line").forEach((line) => {
          line.classList.remove("active");
        });

        if (lineNum) {
          const line = document.querySelector(
            `.code-line[data-line="${lineNum}"]`
          );
          if (line) line.classList.add("active");
        }
      }
    </script>
  </body>
</html>
