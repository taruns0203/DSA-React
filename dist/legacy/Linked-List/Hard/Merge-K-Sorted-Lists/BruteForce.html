<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Merge K Sorted Lists - Brute Force Approach</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&family=Patrick+Hand&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Patrick Hand", cursive;
        background: #f5f5f0;
        min-height: 100vh;
        padding: 20px;
      }

      .whiteboard {
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1),
          inset 0 0 100px rgba(0, 0, 0, 0.02);
        max-width: 1200px;
        margin: 0 auto;
        padding: 30px;
        position: relative;
        border: 12px solid #8b7355;
      }

      .whiteboard::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          90deg,
          transparent 0%,
          transparent 50%,
          rgba(200, 200, 200, 0.03) 50%,
          rgba(200, 200, 200, 0.03) 100%
        );
        background-size: 4px 4px;
        pointer-events: none;
      }

      h1 {
        font-family: "Caveat", cursive;
        font-size: 2.8rem;
        color: #2c5282;
        text-align: center;
        margin-bottom: 10px;
        text-decoration: underline;
        text-decoration-style: wavy;
        text-decoration-color: #e53e3e;
        text-underline-offset: 8px;
      }

      .subtitle {
        text-align: center;
        font-size: 1.4rem;
        color: #666;
        margin-bottom: 25px;
      }

      .phase-indicator {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .phase {
        padding: 10px 20px;
        border-radius: 20px;
        font-size: 1.1rem;
        border: 3px dashed #ccc;
        color: #999;
        transition: all 0.3s ease;
      }

      .phase.active {
        border-color: #48bb78;
        background: #f0fff4;
        color: #276749;
        border-style: solid;
        transform: scale(1.05);
      }

      .phase.completed {
        border-color: #9ae6b4;
        background: #c6f6d5;
        color: #22543d;
        border-style: solid;
      }

      .main-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-bottom: 30px;
      }

      @media (max-width: 900px) {
        .main-content {
          grid-template-columns: 1fr;
        }
      }

      .section {
        background: rgba(255, 255, 255, 0.7);
        border: 3px solid #333;
        border-radius: 12px;
        padding: 20px;
        position: relative;
      }

      .section-title {
        font-family: "Caveat", cursive;
        font-size: 1.6rem;
        color: #2d3748;
        margin-bottom: 15px;
        padding-bottom: 8px;
        border-bottom: 2px solid #e2e8f0;
      }

      .input-lists {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .list-row {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .list-label {
        font-family: "Caveat", cursive;
        font-size: 1.3rem;
        color: #553c9a;
        min-width: 70px;
      }

      .linked-list {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .node {
        width: 50px;
        height: 50px;
        border: 3px solid #333;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.4rem;
        font-weight: bold;
        background: #fff;
        position: relative;
        transition: all 0.4s ease;
      }

      .node.collected {
        background: #fef3c7;
        border-color: #d69e2e;
        transform: scale(0.9);
        opacity: 0.6;
      }

      .node.highlighting {
        background: #fed7e2;
        border-color: #d53f8c;
        transform: scale(1.15);
        box-shadow: 0 0 20px rgba(213, 63, 140, 0.4);
      }

      .arrow {
        font-size: 1.8rem;
        color: #666;
      }

      .null-marker {
        font-size: 1.1rem;
        color: #a0aec0;
        font-style: italic;
      }

      .values-array {
        min-height: 80px;
        border: 3px dashed #805ad5;
        border-radius: 12px;
        padding: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
        background: #faf5ff;
      }

      .array-value {
        width: 45px;
        height: 45px;
        border: 3px solid #805ad5;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.3rem;
        font-weight: bold;
        background: #fff;
        transition: all 0.3s ease;
      }

      .array-value.new {
        animation: popIn 0.4s ease;
        background: #e9d8fd;
      }

      .array-value.sorting {
        background: #fed7e2;
        border-color: #d53f8c;
      }

      .array-value.sorted {
        background: #c6f6d5;
        border-color: #38a169;
      }

      @keyframes popIn {
        0% {
          transform: scale(0);
          opacity: 0;
        }
        50% {
          transform: scale(1.2);
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      .result-section {
        grid-column: 1 / -1;
      }

      .result-list {
        display: flex;
        align-items: center;
        gap: 5px;
        min-height: 60px;
        flex-wrap: wrap;
        padding: 15px;
        background: #f0fff4;
        border-radius: 12px;
        border: 3px solid #48bb78;
      }

      .result-node {
        width: 50px;
        height: 50px;
        border: 3px solid #38a169;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.4rem;
        font-weight: bold;
        background: #fff;
        animation: slideIn 0.4s ease;
      }

      @keyframes slideIn {
        0% {
          transform: translateY(-20px);
          opacity: 0;
        }
        100% {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .result-arrow {
        font-size: 1.5rem;
        color: #38a169;
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 25px;
        flex-wrap: wrap;
      }

      .btn {
        padding: 12px 28px;
        font-family: "Patrick Hand", cursive;
        font-size: 1.2rem;
        border: 3px solid #333;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.2s ease;
        background: #fff;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .btn-primary {
        background: #4299e1;
        color: #fff;
        border-color: #2b6cb0;
      }

      .btn-primary:hover {
        background: #3182ce;
      }

      .btn-success {
        background: #48bb78;
        color: #fff;
        border-color: #276749;
      }

      .btn-warning {
        background: #ed8936;
        color: #fff;
        border-color: #c05621;
      }

      .btn-danger {
        background: #fc8181;
        color: #fff;
        border-color: #c53030;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      .explanation-box {
        background: #fffaf0;
        border: 3px solid #dd6b20;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 25px;
        min-height: 100px;
      }

      .explanation-title {
        font-family: "Caveat", cursive;
        font-size: 1.4rem;
        color: #c05621;
        margin-bottom: 10px;
      }

      .explanation-text {
        font-size: 1.2rem;
        color: #744210;
        line-height: 1.6;
      }

      .code-display {
        font-family: "Courier New", monospace;
        background: #2d3748;
        color: #e2e8f0;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 1rem;
      }

      .complexity-box {
        background: #ebf8ff;
        border: 3px solid #4299e1;
        border-radius: 12px;
        padding: 15px;
        margin-top: 20px;
      }

      .complexity-title {
        font-family: "Caveat", cursive;
        font-size: 1.3rem;
        color: #2b6cb0;
        margin-bottom: 8px;
      }

      .complexity-item {
        font-size: 1.1rem;
        color: #2c5282;
        margin: 5px 0;
      }

      .step-counter {
        text-align: center;
        font-family: "Caveat", cursive;
        font-size: 1.5rem;
        color: #718096;
        margin-bottom: 15px;
      }

      .speed-control {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
        margin-bottom: 20px;
      }

      .speed-label {
        font-size: 1.1rem;
        color: #4a5568;
      }

      .speed-slider {
        width: 150px;
        height: 8px;
        -webkit-appearance: none;
        background: #e2e8f0;
        border-radius: 4px;
        outline: none;
      }

      .speed-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 20px;
        height: 20px;
        background: #4299e1;
        border-radius: 50%;
        cursor: pointer;
      }

      .marker {
        position: absolute;
        font-size: 2rem;
        transition: all 0.3s ease;
        pointer-events: none;
      }

      .empty-placeholder {
        color: #a0aec0;
        font-style: italic;
        font-size: 1.1rem;
      }
    </style>
  </head>
  <body>
    <div class="whiteboard">
      <h1>üéØ Merge K Sorted Lists</h1>
      <p class="subtitle">Brute Force Approach - Interactive Visualization</p>

      <div class="phase-indicator">
        <div class="phase" id="phase1">üì• Step 1: Collect Values</div>
        <div class="phase" id="phase2">üîÑ Step 2: Sort Array</div>
        <div class="phase" id="phase3">üîó Step 3: Build Result</div>
      </div>

      <div class="step-counter" id="stepCounter">Ready to start!</div>

      <div class="controls">
        <button class="btn btn-primary" id="stepBtn" onclick="nextStep()">
          ‚ñ∂ Step
        </button>
        <button class="btn btn-success" id="autoBtn" onclick="toggleAuto()">
          ‚èµ Auto Play
        </button>
        <button class="btn btn-danger" onclick="reset()">‚Ü∫ Reset</button>
      </div>

      <div class="speed-control">
        <span class="speed-label">Speed:</span>
        <input
          type="range"
          class="speed-slider"
          id="speedSlider"
          min="200"
          max="1500"
          value="800"
        />
        <span class="speed-label" id="speedValue">Medium</span>
      </div>

      <div class="explanation-box">
        <div class="explanation-title">üí° Current Action:</div>
        <div class="explanation-text" id="explanation">
          Click <strong>Step</strong> to begin the visualization, or
          <strong>Auto Play</strong> to watch it animate automatically.
          <br /><br />
          <strong>Input:</strong> lists = [[1,4,5], [1,3,4], [2,6]]
        </div>
      </div>

      <div class="main-content">
        <div class="section">
          <div class="section-title">üìã Input: K Sorted Lists</div>
          <div class="input-lists" id="inputLists">
            <!-- Generated by JS -->
          </div>
        </div>

        <div class="section">
          <div class="section-title">üì¶ Values Array</div>
          <div class="values-array" id="valuesArray">
            <span class="empty-placeholder"
              >Empty - values will appear here</span
            >
          </div>
        </div>

        <div class="section result-section">
          <div class="section-title">‚úÖ Result: Merged Sorted List</div>
          <div class="result-list" id="resultList">
            <span class="empty-placeholder">Waiting for sorted array...</span>
          </div>
        </div>
      </div>

      <div class="complexity-box">
        <div class="complexity-title">üìä Complexity Analysis</div>
        <div class="complexity-item">
          ‚è±Ô∏è <strong>Time:</strong> O(N log N) ‚Äî dominated by sorting, where N =
          total nodes
        </div>
        <div class="complexity-item">
          üíæ <strong>Space:</strong> O(N) ‚Äî array stores all values + new result
          nodes
        </div>
        <div class="complexity-item">
          üìù <strong>Trade-off:</strong> Simple but ignores the pre-sorted
          property of input lists
        </div>
      </div>
    </div>

    <script>
      // Input data
      const inputLists = [
        [1, 4, 5],
        [1, 3, 4],
        [2, 6],
      ];

      // State
      let currentStep = 0;
      let currentPhase = 0;
      let collectedValues = [];
      let sortedValues = [];
      let resultNodes = [];
      let isAutoPlaying = false;
      let autoInterval = null;
      let currentListIndex = 0;
      let currentNodeIndex = 0;
      let sortStep = 0;
      let buildStep = 0;

      // Speed control
      const speedSlider = document.getElementById("speedSlider");
      const speedValue = document.getElementById("speedValue");

      speedSlider.addEventListener("input", () => {
        const val = speedSlider.value;
        if (val < 500) speedValue.textContent = "Fast";
        else if (val < 1000) speedValue.textContent = "Medium";
        else speedValue.textContent = "Slow";
      });

      function getSpeed() {
        return parseInt(speedSlider.value);
      }

      // Initialize display
      function initDisplay() {
        const container = document.getElementById("inputLists");
        container.innerHTML = "";

        inputLists.forEach((list, idx) => {
          const row = document.createElement("div");
          row.className = "list-row";

          const label = document.createElement("span");
          label.className = "list-label";
          label.textContent = `List ${idx}:`;
          row.appendChild(label);

          const linkedList = document.createElement("div");
          linkedList.className = "linked-list";
          linkedList.id = `list-${idx}`;

          list.forEach((val, nodeIdx) => {
            const node = document.createElement("div");
            node.className = "node";
            node.id = `node-${idx}-${nodeIdx}`;
            node.textContent = val;
            linkedList.appendChild(node);

            if (nodeIdx < list.length - 1) {
              const arrow = document.createElement("span");
              arrow.className = "arrow";
              arrow.textContent = "‚Üí";
              linkedList.appendChild(arrow);
            }
          });

          const nullMarker = document.createElement("span");
          nullMarker.className = "null-marker";
          nullMarker.textContent = " ‚Üí null";
          linkedList.appendChild(nullMarker);

          row.appendChild(linkedList);
          container.appendChild(row);
        });
      }

      function updatePhaseIndicator() {
        document.getElementById("phase1").className =
          "phase" +
          (currentPhase === 0
            ? " active"
            : currentPhase > 0
            ? " completed"
            : "");
        document.getElementById("phase2").className =
          "phase" +
          (currentPhase === 1
            ? " active"
            : currentPhase > 1
            ? " completed"
            : "");
        document.getElementById("phase3").className =
          "phase" +
          (currentPhase === 2
            ? " active"
            : currentPhase > 2
            ? " completed"
            : "");
      }

      function updateValuesArray() {
        const container = document.getElementById("valuesArray");
        container.innerHTML = "";

        if (collectedValues.length === 0) {
          container.innerHTML =
            '<span class="empty-placeholder">Empty - values will appear here</span>';
          return;
        }

        collectedValues.forEach((val, idx) => {
          const elem = document.createElement("div");
          elem.className = "array-value";
          elem.id = `arr-${idx}`;
          elem.textContent = val;
          if (idx === collectedValues.length - 1 && currentPhase === 0) {
            elem.classList.add("new");
          }
          if (currentPhase === 1 && sortedValues.length > 0) {
            elem.classList.add("sorted");
          }
          container.appendChild(elem);
        });
      }

      function updateResultList() {
        const container = document.getElementById("resultList");
        container.innerHTML = "";

        if (resultNodes.length === 0) {
          container.innerHTML =
            '<span class="empty-placeholder">Waiting for sorted array...</span>';
          return;
        }

        resultNodes.forEach((val, idx) => {
          const node = document.createElement("div");
          node.className = "result-node";
          node.textContent = val;
          container.appendChild(node);

          if (idx < resultNodes.length - 1) {
            const arrow = document.createElement("span");
            arrow.className = "result-arrow";
            arrow.textContent = "‚Üí";
            container.appendChild(arrow);
          }
        });

        // Add null marker at the end if complete
        if (currentPhase >= 3) {
          const nullMarker = document.createElement("span");
          nullMarker.className = "null-marker";
          nullMarker.style.marginLeft = "5px";
          nullMarker.textContent = "‚Üí null";
          container.appendChild(nullMarker);
        }
      }

      function setExplanation(text) {
        document.getElementById("explanation").innerHTML = text;
      }

      function setStepCounter(text) {
        document.getElementById("stepCounter").textContent = text;
      }

      function clearHighlights() {
        document.querySelectorAll(".node").forEach((n) => {
          n.classList.remove("highlighting");
        });
      }

      function nextStep() {
        clearHighlights();

        // Phase 0: Collecting values
        if (currentPhase === 0) {
          if (currentListIndex < inputLists.length) {
            const list = inputLists[currentListIndex];

            if (currentNodeIndex < list.length) {
              // Highlight current node
              const node = document.getElementById(
                `node-${currentListIndex}-${currentNodeIndex}`
              );
              node.classList.add("highlighting");

              // Collect value
              const val = list[currentNodeIndex];
              collectedValues.push(val);
              updateValuesArray();

              setStepCounter(`Step ${currentStep + 1}: Collecting values`);
              setExplanation(
                `Traversing <span class="code-display">List ${currentListIndex}</span>, ` +
                  `visiting node with value <span class="code-display">${val}</span>.<br><br>` +
                  `Adding <strong>${val}</strong> to values array.<br>` +
                  `Current array: [${collectedValues.join(", ")}]`
              );

              currentNodeIndex++;

              // Mark as collected after a brief moment
              setTimeout(() => {
                node.classList.remove("highlighting");
                node.classList.add("collected");
              }, getSpeed() * 0.8);
            } else {
              // Move to next list
              currentListIndex++;
              currentNodeIndex = 0;
              nextStep();
              return;
            }
          } else {
            // Done collecting, move to sorting phase
            currentPhase = 1;
            updatePhaseIndicator();
            setStepCounter(`Step ${currentStep + 1}: Starting sort`);
            setExplanation(
              `All values collected! Total: <strong>${collectedValues.length}</strong> values.<br><br>` +
                `Unsorted array: [${collectedValues.join(", ")}]<br><br>` +
                `Now we'll sort this array using <span class="code-display">O(N log N)</span> sort.`
            );
          }
        }
        // Phase 1: Sorting
        else if (currentPhase === 1) {
          // Perform sort in one step (animated)
          sortedValues = [...collectedValues].sort((a, b) => a - b);
          collectedValues = [...sortedValues];
          updateValuesArray();

          // Add sorted class to all
          document.querySelectorAll(".array-value").forEach((el) => {
            el.classList.add("sorted");
          });

          setStepCounter(`Step ${currentStep + 1}: Array sorted!`);
          setExplanation(
            `Sorting complete! üéâ<br><br>` +
              `Sorted array: [${sortedValues.join(", ")}]<br><br>` +
              `Time taken for sort: <span class="code-display">O(N log N)</span> where N = ${sortedValues.length}`
          );

          currentPhase = 2;
          updatePhaseIndicator();
        }
        // Phase 2: Building result
        else if (currentPhase === 2) {
          if (buildStep < sortedValues.length) {
            const val = sortedValues[buildStep];
            resultNodes.push(val);
            updateResultList();

            // Highlight corresponding array element
            const arrElem = document.getElementById(`arr-${buildStep}`);
            if (arrElem) {
              arrElem.style.opacity = "0.5";
              arrElem.style.transform = "scale(0.8)";
            }

            setStepCounter(
              `Step ${currentStep + 1}: Building result node ${buildStep + 1}/${
                sortedValues.length
              }`
            );
            setExplanation(
              `Creating new <span class="code-display">ListNode(${val})</span> and appending to result.<br><br>` +
                `<span class="code-display">current.next = new ListNode(${val})</span><br>` +
                `<span class="code-display">current = current.next</span><br><br>` +
                `Result so far: ${resultNodes.join(" ‚Üí ")} ‚Üí null`
            );

            buildStep++;
          } else {
            // Done!
            currentPhase = 3;
            updatePhaseIndicator();
            updateResultList();

            setStepCounter("‚úÖ Complete!");
            setExplanation(
              `<strong>üéâ Merge complete!</strong><br><br>` +
                `Final merged list: <strong>${resultNodes.join(
                  " ‚Üí "
                )} ‚Üí null</strong><br><br>` +
                `Summary:<br>` +
                `‚Ä¢ Collected ${sortedValues.length} values from ${inputLists.length} lists<br>` +
                `‚Ä¢ Sorted in O(N log N) time<br>` +
                `‚Ä¢ Built new linked list in O(N) time<br><br>` +
                `Total: <span class="code-display">O(N log N)</span> time, <span class="code-display">O(N)</span> space`
            );

            document.getElementById("stepBtn").disabled = true;
            stopAuto();
          }
        }

        currentStep++;
        updatePhaseIndicator();
      }

      function toggleAuto() {
        if (isAutoPlaying) {
          stopAuto();
        } else {
          startAuto();
        }
      }

      function startAuto() {
        isAutoPlaying = true;
        document.getElementById("autoBtn").textContent = "‚è∏ Pause";
        document.getElementById("autoBtn").classList.remove("btn-success");
        document.getElementById("autoBtn").classList.add("btn-warning");

        autoInterval = setInterval(() => {
          if (currentPhase >= 3) {
            stopAuto();
            return;
          }
          nextStep();
        }, getSpeed());
      }

      function stopAuto() {
        isAutoPlaying = false;
        document.getElementById("autoBtn").textContent = "‚èµ Auto Play";
        document.getElementById("autoBtn").classList.remove("btn-warning");
        document.getElementById("autoBtn").classList.add("btn-success");

        if (autoInterval) {
          clearInterval(autoInterval);
          autoInterval = null;
        }
      }

      function reset() {
        stopAuto();

        currentStep = 0;
        currentPhase = 0;
        collectedValues = [];
        sortedValues = [];
        resultNodes = [];
        currentListIndex = 0;
        currentNodeIndex = 0;
        sortStep = 0;
        buildStep = 0;

        document.getElementById("stepBtn").disabled = false;

        initDisplay();
        updatePhaseIndicator();
        updateValuesArray();
        updateResultList();

        setStepCounter("Ready to start!");
        setExplanation(
          `Click <strong>Step</strong> to begin the visualization, or <strong>Auto Play</strong> to watch it animate automatically.` +
            `<br><br><strong>Input:</strong> lists = [[1,4,5], [1,3,4], [2,6]]`
        );
      }

      // Keyboard support
      document.addEventListener("keydown", (e) => {
        if (e.code === "Space") {
          e.preventDefault();
          if (currentPhase < 3) nextStep();
        } else if (e.code === "KeyR") {
          reset();
        } else if (e.code === "KeyA") {
          toggleAuto();
        }
      });

      // Initialize on load
      initDisplay();
      updatePhaseIndicator();
    </script>
  </body>
</html>
