<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Odd Even Linked List - Optimal Interleaved Rewiring</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&family=Indie+Flower&family=Kalam:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Kalam", cursive;
        background: #8b7355;
        min-height: 100vh;
        overflow-x: hidden;
        padding: 20px;
      }

      /* Notebook paper container */
      .notebook {
        background: #fffef0;
        min-height: calc(100vh - 40px);
        max-width: 1500px;
        margin: 0 auto;
        position: relative;
        box-shadow: 0 0 0 1px #d4c4a8, 5px 5px 20px rgba(0, 0, 0, 0.3),
          -2px 0 10px rgba(0, 0, 0, 0.1);
        border-radius: 0 8px 8px 0;
      }

      /* Red margin line */
      .notebook::before {
        content: "";
        position: absolute;
        top: 0;
        left: 60px;
        bottom: 0;
        width: 2px;
        background: #ffb3b3;
        z-index: 1;
      }

      /* Spiral binding holes */
      .notebook::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        width: 50px;
        background: radial-gradient(
            circle at 25px 30px,
            #8b7355 8px,
            transparent 8px
          ),
          radial-gradient(circle at 25px 80px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 130px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 180px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 230px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 280px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 330px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 380px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 430px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 480px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 530px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 580px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 630px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 680px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 730px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 780px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 830px, #8b7355 8px, transparent 8px),
          radial-gradient(circle at 25px 880px, #8b7355 8px, transparent 8px);
        pointer-events: none;
      }

      /* Lined paper effect */
      .paper-lines {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: repeating-linear-gradient(
          transparent,
          transparent 31px,
          #c8e0f4 31px,
          #c8e0f4 32px
        );
        pointer-events: none;
        opacity: 0.6;
      }

      .content-wrapper {
        padding: 25px 30px 25px 80px;
        position: relative;
        z-index: 2;
      }

      .title {
        font-family: "Caveat", cursive;
        font-size: 2.6rem;
        font-weight: 700;
        color: #2c3e50;
        text-align: center;
        margin-bottom: 5px;
        text-decoration: underline;
        text-decoration-style: wavy;
        text-decoration-color: #e74c3c;
        text-underline-offset: 8px;
      }

      .subtitle {
        font-family: "Indie Flower", cursive;
        font-size: 1.3rem;
        color: #e74c3c;
        text-align: center;
        margin-bottom: 20px;
      }

      .optimal-badge {
        display: inline-block;
        background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
        padding: 3px 12px;
        border-radius: 12px;
        font-size: 0.9rem;
        color: #6c5ce7;
        border: 2px solid #6c5ce7;
        margin-left: 10px;
        transform: rotate(-2deg);
      }

      /* Main content grid */
      .content {
        display: grid;
        grid-template-columns: 1fr 300px;
        gap: 25px;
      }

      /* Visualization area */
      .viz-area {
        background: rgba(255, 255, 255, 0.5);
        border: 2px solid #2c3e50;
        border-radius: 8px;
        padding: 20px;
        position: relative;
      }

      .section-label {
        font-family: "Caveat", cursive;
        font-size: 1.35rem;
        font-weight: 700;
        color: #2c3e50;
        margin: 18px 0 12px 0;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .section-label::before {
        content: "‚Üí";
        color: #e74c3c;
        font-size: 1.2rem;
      }

      /* Linked list visualization */
      .linked-list-container {
        position: relative;
        padding: 30px 15px 50px 15px;
        min-height: 140px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 8px;
        border: 1px dashed #bdc3c7;
      }

      .linked-list {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: 5px;
      }

      .node {
        display: flex;
        align-items: center;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
      }

      .node-box {
        width: 52px;
        height: 52px;
        border: 3px solid #2c3e50;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Caveat", cursive;
        font-size: 1.7rem;
        font-weight: 700;
        background: #fffef0;
        position: relative;
        transition: all 0.3s ease;
        box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.1);
      }

      .node-box.highlight-odd {
        transform: scale(1.15);
        border-color: #f39c12;
        box-shadow: 0 0 0 4px rgba(243, 156, 18, 0.3);
        background: #ffeaa7;
      }

      .node-box.highlight-even {
        transform: scale(1.15);
        border-color: #27ae60;
        box-shadow: 0 0 0 4px rgba(39, 174, 96, 0.3);
        background: #a8e6cf;
      }

      .node-box.even-node {
        background: linear-gradient(135deg, #d5f5e3 0%, #a8e6cf 100%);
        border-color: #27ae60;
        color: #1e8449;
      }

      .node-box.odd-node {
        background: linear-gradient(135deg, #fef9e7 0%, #fdebd0 100%);
        border-color: #f39c12;
        color: #b7950b;
      }

      .index-label {
        position: absolute;
        top: -22px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.75rem;
        color: #7f8c8d;
        font-weight: 600;
        font-family: "Kalam", cursive;
      }

      .pointer-indicator {
        position: absolute;
        bottom: -28px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.7rem;
        padding: 2px 6px;
        border-radius: 4px;
        font-family: "Courier New", monospace;
        white-space: nowrap;
        font-weight: bold;
      }

      .pointer-indicator.odd-ptr {
        background: #f39c12;
        color: white;
      }

      .pointer-indicator.even-ptr {
        background: #27ae60;
        color: white;
      }

      .arrow {
        font-size: 1.4rem;
        color: #2c3e50;
        margin: 0 3px;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .arrow.rewired {
        color: #9b59b6;
        font-weight: 900;
        text-shadow: 0 0 8px rgba(155, 89, 182, 0.5);
      }

      .arrow.broken {
        color: #e74c3c;
        opacity: 0.4;
        text-decoration: line-through;
      }

      .null-box {
        padding: 6px 12px;
        background: #ecf0f1;
        border: 2px dashed #95a5a6;
        border-radius: 4px;
        font-family: "Kalam", cursive;
        color: #7f8c8d;
        font-size: 0.9rem;
      }

      /* Chain visualization */
      .chains-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin: 15px 0;
      }

      .chain-box {
        background: rgba(255, 255, 255, 0.5);
        border: 2px solid #2c3e50;
        border-radius: 8px;
        padding: 15px;
        position: relative;
        min-height: 100px;
      }

      .chain-box.even-chain {
        border-color: #27ae60;
        border-style: solid;
      }

      .chain-box.even-chain .chain-title {
        background: #27ae60;
      }

      .chain-box.odd-chain {
        border-color: #f39c12;
        border-style: solid;
      }

      .chain-box.odd-chain .chain-title {
        background: #f39c12;
      }

      .chain-title {
        position: absolute;
        top: -10px;
        left: 15px;
        padding: 2px 10px;
        border-radius: 4px;
        font-size: 0.8rem;
        color: white;
        font-family: "Kalam", cursive;
        font-weight: 700;
      }

      .chain-content {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: 4px;
        min-height: 50px;
        padding-top: 10px;
      }

      .chain-node {
        width: 42px;
        height: 42px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Caveat", cursive;
        font-size: 1.4rem;
        font-weight: 700;
        border: 3px solid;
        transition: all 0.3s ease;
      }

      .chain-node.even {
        background: linear-gradient(135deg, #d5f5e3 0%, #a8e6cf 100%);
        border-color: #27ae60;
        color: #1e8449;
      }

      .chain-node.odd {
        background: linear-gradient(135deg, #fef9e7 0%, #fdebd0 100%);
        border-color: #f39c12;
        color: #b7950b;
      }

      .chain-arrow {
        font-size: 1.2rem;
        color: #2c3e50;
        margin: 0 2px;
      }

      .empty-chain {
        color: #bdc3c7;
        font-style: italic;
        font-size: 0.95rem;
      }

      /* Result area */
      .result-area {
        margin-top: 15px;
        padding: 15px;
        background: linear-gradient(
          135deg,
          rgba(155, 89, 182, 0.1),
          rgba(142, 68, 173, 0.1)
        );
        border-radius: 8px;
        border: 2px solid #9b59b6;
      }

      .result-label {
        font-family: "Caveat", cursive;
        font-size: 1.2rem;
        font-weight: 700;
        color: #8e44ad;
        margin-bottom: 10px;
        text-align: center;
      }

      /* Rewiring animation indicator */
      .rewire-indicator {
        position: absolute;
        font-family: "Indie Flower", cursive;
        font-size: 0.9rem;
        color: #9b59b6;
        background: rgba(255, 255, 255, 0.9);
        padding: 3px 8px;
        border-radius: 4px;
        border: 1px solid #9b59b6;
        animation: pulse 1s ease-in-out infinite;
        white-space: nowrap;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.05);
        }
      }

      /* Controls panel */
      .controls-panel {
        background: rgba(255, 255, 255, 0.7);
        border: 2px solid #2c3e50;
        border-radius: 8px;
        padding: 18px;
        position: sticky;
        top: 20px;
      }

      .step-info {
        background: #fffef0;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 15px;
        border-left: 4px solid #9b59b6;
        box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.05);
      }

      .step-number {
        font-family: "Caveat", cursive;
        font-size: 1.5rem;
        color: #9b59b6;
        font-weight: 700;
      }

      .step-description {
        font-size: 0.95rem;
        color: #2c3e50;
        margin-top: 6px;
        line-height: 1.4;
      }

      /* Complexity badge */
      .complexity-badge {
        display: inline-block;
        background: linear-gradient(135deg, #a8e6cf, #88d8b0);
        padding: 8px 12px;
        border-radius: 8px;
        margin: 10px 0;
        border: 2px solid #27ae60;
        width: 100%;
        text-align: center;
      }

      .complexity-text {
        font-family: "Kalam", cursive;
        font-size: 0.9rem;
        color: #1e8449;
        font-weight: 700;
      }

      /* Buttons */
      .btn-group {
        display: flex;
        gap: 8px;
        margin-bottom: 12px;
      }

      .btn {
        flex: 1;
        padding: 10px 12px;
        border: 2px solid #2c3e50;
        border-radius: 20px;
        font-family: "Kalam", cursive;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.2s ease;
        font-weight: 600;
      }

      .btn:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.15);
      }

      .btn:active:not(:disabled) {
        transform: translateY(0);
        box-shadow: none;
      }

      .btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      .btn-prev {
        background: #ecf0f1;
        color: #2c3e50;
      }

      .btn-next {
        background: #9b59b6;
        color: white;
        border-color: #8e44ad;
      }

      .btn-reset {
        background: #e74c3c;
        color: white;
        border-color: #c0392b;
        width: 100%;
      }

      .btn-auto {
        background: #27ae60;
        color: white;
        border-color: #1e8449;
        width: 100%;
        margin-top: 8px;
      }

      .btn-auto.playing {
        background: #f39c12;
        border-color: #d68910;
      }

      /* Variable state */
      .var-state {
        background: #2c3e50;
        border-radius: 8px;
        padding: 12px;
        margin-top: 15px;
      }

      .var-title {
        color: #ecf0f1;
        font-size: 0.95rem;
        margin-bottom: 10px;
        padding-bottom: 6px;
        border-bottom: 1px solid #34495e;
      }

      .var-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 4px 0;
        font-size: 0.85rem;
      }

      .var-name {
        color: #f39c12;
        font-family: "Courier New", monospace;
      }

      .var-value {
        color: #2ecc71;
        font-family: "Courier New", monospace;
        background: rgba(46, 204, 113, 0.1);
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 0.8rem;
      }

      /* Code display */
      .code-box {
        background: #1a1a2e;
        border-radius: 8px;
        padding: 12px;
        margin-top: 15px;
        overflow-x: auto;
        max-height: 180px;
        overflow-y: auto;
      }

      .code-line {
        font-family: "Courier New", monospace;
        font-size: 0.68rem;
        color: rgba(255, 255, 255, 0.7);
        padding: 2px 0;
        white-space: pre;
        transition: all 0.3s ease;
      }

      .code-line.active {
        background: rgba(155, 89, 182, 0.3);
        border-left: 2px solid #9b59b6;
        padding-left: 8px;
        margin-left: -8px;
        color: #f5f5dc;
      }

      .code-keyword {
        color: #e056fd;
      }

      .code-var {
        color: #f39c12;
      }

      .code-comment {
        color: rgba(255, 255, 255, 0.4);
      }

      /* Progress bar */
      .progress-container {
        margin-top: 15px;
      }

      .progress-label {
        font-size: 0.85rem;
        color: #7f8c8d;
        margin-bottom: 6px;
      }

      .progress-bar {
        height: 8px;
        background: #ecf0f1;
        border-radius: 4px;
        overflow: hidden;
        border: 1px solid #bdc3c7;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #9b59b6, #e74c3c, #f39c12);
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      /* Legend */
      .legend {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 15px 0;
        flex-wrap: wrap;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9rem;
        color: #2c3e50;
      }

      .legend-color {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        border: 2px solid;
      }

      .legend-color.even {
        background: linear-gradient(135deg, #d5f5e3 0%, #a8e6cf 100%);
        border-color: #27ae60;
      }

      .legend-color.odd {
        background: linear-gradient(135deg, #fef9e7 0%, #fdebd0 100%);
        border-color: #f39c12;
      }

      /* Key insight */
      .insight-box {
        background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
        border: 2px solid #f39c12;
        border-radius: 8px;
        padding: 10px 15px;
        margin: 15px 0;
        text-align: center;
        transform: rotate(-0.5deg);
      }

      .insight-icon {
        font-size: 1.2rem;
        margin-right: 8px;
      }

      .insight-text {
        font-family: "Indie Flower", cursive;
        font-size: 1rem;
        color: #6c5ce7;
      }

      /* Responsive */
      @media (max-width: 950px) {
        .content {
          grid-template-columns: 1fr;
        }

        .controls-panel {
          position: static;
        }

        .title {
          font-size: 2rem;
        }

        .chains-container {
          grid-template-columns: 1fr;
        }

        .content-wrapper {
          padding: 20px 20px 20px 70px;
        }
      }

      /* Hand-drawn arrow animation */
      @keyframes drawArrow {
        from {
          stroke-dashoffset: 100;
        }
        to {
          stroke-dashoffset: 0;
        }
      }

      .sketch-arrow {
        stroke-dasharray: 100;
        animation: drawArrow 0.5s ease forwards;
      }
    </style>
  </head>
  <body>
    <div class="notebook">
      <div class="paper-lines"></div>
      <div class="content-wrapper">
        <h1 class="title">
          Odd Even Linked List
          <span class="optimal-badge">‚ú® OPTIMAL</span>
        </h1>
        <p class="subtitle">
          Interleaved Pointer Rewiring ‚Äî O(n) Time, O(1) Space
        </p>

        <div class="legend">
          <div class="legend-item">
            <div class="legend-color even"></div>
            <span>Even Index (2, 4, 6...)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color odd"></div>
            <span>Odd Index (1, 3, 5...)</span>
          </div>
        </div>

        <div class="content">
          <div class="viz-area">
            <div class="section-label">Original List with Pointer Tracking</div>
            <div class="linked-list-container">
              <div class="linked-list" id="originalList"></div>
            </div>

            <div class="insight-box">
              <span class="insight-icon">üí°</span>
              <span class="insight-text" id="insightText"
                >We rewire pointers as we go - no extra data structures
                needed!</span
              >
            </div>

            <div class="section-label">Building Two Chains Simultaneously</div>
            <div class="chains-container">
              <div class="chain-box even-chain">
                <div class="chain-title">Even Chain (starts at index 2)</div>
                <div class="chain-content" id="evenChain">
                  <span class="empty-chain">evenHead ‚Üí</span>
                </div>
              </div>
              <div class="chain-box odd-chain">
                <div class="chain-title">Odd Chain (starts at index 1)</div>
                <div class="chain-content" id="oddChain">
                  <span class="empty-chain">head ‚Üí</span>
                </div>
              </div>
            </div>

            <div class="result-area">
              <div class="result-label">
                üéØ Final Result: evenHead ‚Üí ... ‚Üí evenTail ‚Üí head ‚Üí ... ‚Üí
                oddTail ‚Üí null
              </div>
              <div class="linked-list" id="resultList">
                <span class="empty-chain">Waiting for final connection...</span>
              </div>
            </div>
          </div>

          <div class="controls-panel">
            <div class="step-info">
              <div class="step-number" id="stepNumber">Step 0 / 18</div>
              <div class="step-description" id="stepDescription">
                Click "Next" to begin the optimal algorithm
              </div>
            </div>

            <div class="complexity-badge">
              <div class="complexity-text">
                ‚ö° Time: O(n) | Space: O(1) - Just 4 pointers!
              </div>
            </div>

            <div class="btn-group">
              <button class="btn btn-prev" id="prevBtn" disabled>‚Üê Prev</button>
              <button class="btn btn-next" id="nextBtn">Next ‚Üí</button>
            </div>
            <button class="btn btn-reset" id="resetBtn">üîÑ Reset</button>
            <button class="btn btn-auto" id="autoBtn">‚ñ∂ Auto Play</button>

            <div class="var-state">
              <div class="var-title">üìç Pointer Positions</div>
              <div class="var-item">
                <span class="var-name">odd</span>
                <span class="var-value" id="varOdd">node(1)</span>
              </div>
              <div class="var-item">
                <span class="var-name">even</span>
                <span class="var-value" id="varEven">node(2)</span>
              </div>
              <div class="var-item">
                <span class="var-name">evenHead</span>
                <span class="var-value" id="varEvenHead">node(2)</span>
              </div>
              <div class="var-item">
                <span class="var-name">odd.next</span>
                <span class="var-value" id="varOddNext">node(2)</span>
              </div>
              <div class="var-item">
                <span class="var-name">even.next</span>
                <span class="var-value" id="varEvenNext">node(3)</span>
              </div>
            </div>

            <div class="code-box">
              <div class="code-line" id="code0">
                <span class="code-var">odd</span> = head;
                <span class="code-var">even</span> = head.next;
              </div>
              <div class="code-line" id="code1">
                <span class="code-var">evenHead</span> = even;
              </div>
              <div class="code-line" id="code2">
                <span class="code-keyword">while</span> (even && even.next) {
              </div>
              <div class="code-line" id="code3">
                <span class="code-var">odd</span>.next =
                <span class="code-var">even</span>.next;
              </div>
              <div class="code-line" id="code4">
                <span class="code-var">odd</span> =
                <span class="code-var">odd</span>.next;
              </div>
              <div class="code-line" id="code5">
                <span class="code-var">even</span>.next =
                <span class="code-var">odd</span>.next;
              </div>
              <div class="code-line" id="code6">
                <span class="code-var">even</span> =
                <span class="code-var">even</span>.next;
              </div>
              <div class="code-line" id="code7">}</div>
              <div class="code-line" id="code8">
                <span class="code-var">odd</span>.next =
                <span class="code-keyword">null</span>;
              </div>
              <div class="code-line" id="code9">
                <span class="code-var">evenTail</span>.next = head;
              </div>
              <div class="code-line" id="code10">
                <span class="code-keyword">return</span>
                <span class="code-var">evenHead</span>;
              </div>
            </div>

            <div class="progress-container">
              <div class="progress-label">Progress</div>
              <div class="progress-bar">
                <div
                  class="progress-fill"
                  id="progressFill"
                  style="width: 0%"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Input data
      const inputValues = [1, 2, 3, 4, 5, 6];

      // State
      let currentStep = 0;
      let autoPlayInterval = null;
      let oddChain = [];
      let evenChain = [];
      let resultNodes = [];
      let rewiredLinks = {}; // Track which links have been rewired

      // Pointer positions (1-indexed node values for display)
      let pointerState = {
        odd: 1,
        even: 2,
        evenHead: 2,
        oddNext: 2,
        evenNext: 3,
      };

      // Steps definition
      const steps = [
        {
          description:
            "Input: 1‚Üí2‚Üí3‚Üí4‚Üí5‚Üí6‚Üínull. The optimal approach uses interleaved pointer rewiring with just O(1) extra space!",
          odd: "node(1)",
          even: "node(2)",
          evenHead: "node(2)",
          oddNext: "node(2)",
          evenNext: "node(3)",
          oddPos: 0,
          evenPos: 1,
          codeLine: -1,
          insight:
            "Key insight: We maintain two pointers and rewire as we traverse!",
          action: "init",
          oddChainVals: [],
          evenChainVals: [],
        },
        {
          description:
            "Initialize: odd = head (node 1), even = head.next (node 2), evenHead = even (save for later)",
          odd: "node(1)",
          even: "node(2)",
          evenHead: "node(2)",
          oddNext: "node(2)",
          evenNext: "node(3)",
          oddPos: 0,
          evenPos: 1,
          codeLine: 0,
          insight: "evenHead saved! We'll need it to return the final result.",
          action: "init",
          oddChainVals: [1],
          evenChainVals: [2],
        },
        {
          description:
            "Check loop: even (node 2) exists ‚úì AND even.next (node 3) exists ‚úì. Enter loop!",
          odd: "node(1)",
          even: "node(2)",
          evenHead: "node(2)",
          oddNext: "node(2)",
          evenNext: "node(3)",
          oddPos: 0,
          evenPos: 1,
          codeLine: 2,
          insight: "Loop condition checks if there are more nodes to process.",
          action: "check",
          oddChainVals: [1],
          evenChainVals: [2],
        },
        {
          description:
            "REWIRE ODD: odd.next = even.next ‚Üí node(1).next = node(3). Now 1 points to 3, skipping 2!",
          odd: "node(1)",
          even: "node(2)",
          evenHead: "node(2)",
          oddNext: "node(3)",
          evenNext: "node(3)",
          oddPos: 0,
          evenPos: 1,
          codeLine: 3,
          insight:
            "üîó First rewire! Node 1 now skips node 2 and points to node 3.",
          action: "rewireOdd",
          rewire: { from: 0, to: 2 },
          oddChainVals: [1],
          evenChainVals: [2],
        },
        {
          description:
            "ADVANCE ODD: odd = odd.next ‚Üí odd moves from node(1) to node(3)",
          odd: "node(3)",
          even: "node(2)",
          evenHead: "node(2)",
          oddNext: "node(4)",
          evenNext: "node(3)",
          oddPos: 2,
          evenPos: 1,
          codeLine: 4,
          insight: "Odd pointer now at node 3 (the next odd-indexed node).",
          action: "advanceOdd",
          oddChainVals: [1, 3],
          evenChainVals: [2],
        },
        {
          description:
            "REWIRE EVEN: even.next = odd.next ‚Üí node(2).next = node(4). Now 2 points to 4, skipping 3!",
          odd: "node(3)",
          even: "node(2)",
          evenHead: "node(2)",
          oddNext: "node(4)",
          evenNext: "node(4)",
          oddPos: 2,
          evenPos: 1,
          codeLine: 5,
          insight:
            "üîó Second rewire! Node 2 now skips node 3 and points to node 4.",
          action: "rewireEven",
          rewire: { from: 1, to: 3 },
          oddChainVals: [1, 3],
          evenChainVals: [2],
        },
        {
          description:
            "ADVANCE EVEN: even = even.next ‚Üí even moves from node(2) to node(4)",
          odd: "node(3)",
          even: "node(4)",
          evenHead: "node(2)",
          oddNext: "node(4)",
          evenNext: "node(5)",
          oddPos: 2,
          evenPos: 3,
          codeLine: 6,
          insight: "Even pointer now at node 4 (the next even-indexed node).",
          action: "advanceEven",
          oddChainVals: [1, 3],
          evenChainVals: [2, 4],
        },
        {
          description:
            "Check loop: even (node 4) exists ‚úì AND even.next (node 5) exists ‚úì. Continue loop!",
          odd: "node(3)",
          even: "node(4)",
          evenHead: "node(2)",
          oddNext: "node(4)",
          evenNext: "node(5)",
          oddPos: 2,
          evenPos: 3,
          codeLine: 2,
          insight: "More nodes to process - entering iteration 2!",
          action: "check",
          oddChainVals: [1, 3],
          evenChainVals: [2, 4],
        },
        {
          description:
            "REWIRE ODD: odd.next = even.next ‚Üí node(3).next = node(5). Now 3 points to 5!",
          odd: "node(3)",
          even: "node(4)",
          evenHead: "node(2)",
          oddNext: "node(5)",
          evenNext: "node(5)",
          oddPos: 2,
          evenPos: 3,
          codeLine: 3,
          insight: "üîó Node 3 now skips node 4 and points to node 5.",
          action: "rewireOdd",
          rewire: { from: 2, to: 4 },
          oddChainVals: [1, 3],
          evenChainVals: [2, 4],
        },
        {
          description:
            "ADVANCE ODD: odd = odd.next ‚Üí odd moves from node(3) to node(5)",
          odd: "node(5)",
          even: "node(4)",
          evenHead: "node(2)",
          oddNext: "node(6)",
          evenNext: "node(5)",
          oddPos: 4,
          evenPos: 3,
          codeLine: 4,
          insight: "Odd pointer now at node 5.",
          action: "advanceOdd",
          oddChainVals: [1, 3, 5],
          evenChainVals: [2, 4],
        },
        {
          description:
            "REWIRE EVEN: even.next = odd.next ‚Üí node(4).next = node(6). Now 4 points to 6!",
          odd: "node(5)",
          even: "node(4)",
          evenHead: "node(2)",
          oddNext: "node(6)",
          evenNext: "node(6)",
          oddPos: 4,
          evenPos: 3,
          codeLine: 5,
          insight: "üîó Node 4 now skips node 5 and points to node 6.",
          action: "rewireEven",
          rewire: { from: 3, to: 5 },
          oddChainVals: [1, 3, 5],
          evenChainVals: [2, 4],
        },
        {
          description:
            "ADVANCE EVEN: even = even.next ‚Üí even moves from node(4) to node(6)",
          odd: "node(5)",
          even: "node(6)",
          evenHead: "node(2)",
          oddNext: "node(6)",
          evenNext: "null",
          oddPos: 4,
          evenPos: 5,
          codeLine: 6,
          insight: "Even pointer now at node 6 (last even-indexed node).",
          action: "advanceEven",
          oddChainVals: [1, 3, 5],
          evenChainVals: [2, 4, 6],
        },
        {
          description:
            "Check loop: even (node 6) exists ‚úì BUT even.next is null ‚úó. EXIT loop!",
          odd: "node(5)",
          even: "node(6)",
          evenHead: "node(2)",
          oddNext: "node(6)",
          evenNext: "null",
          oddPos: 4,
          evenPos: 5,
          codeLine: 7,
          insight: "No more nodes! Both chains are complete.",
          action: "loopEnd",
          oddChainVals: [1, 3, 5],
          evenChainVals: [2, 4, 6],
        },
        {
          description:
            "TERMINATE ODD CHAIN: odd.next = null ‚Üí node(5).next = null. Prevents cycles!",
          odd: "node(5)",
          even: "node(6)",
          evenHead: "node(2)",
          oddNext: "null",
          evenNext: "null",
          oddPos: 4,
          evenPos: 5,
          codeLine: 8,
          insight:
            "‚ö†Ô∏è Critical! Without this, node 5 still points to node 6 creating issues.",
          action: "terminate",
          oddChainVals: [1, 3, 5],
          evenChainVals: [2, 4, 6],
        },
        {
          description:
            "FIND EVEN TAIL: Traverse from evenHead (node 2) to find the last even node (node 6)",
          odd: "node(5)",
          even: "node(6)",
          evenHead: "node(2)",
          oddNext: "null",
          evenNext: "null",
          oddPos: 4,
          evenPos: 5,
          codeLine: 9,
          insight: "evenTail = node(6). Ready for the final connection!",
          action: "findTail",
          oddChainVals: [1, 3, 5],
          evenChainVals: [2, 4, 6],
        },
        {
          description:
            "CONNECT CHAINS: evenTail.next = head ‚Üí node(6).next = node(1). Link even tail to odd head!",
          odd: "node(5)",
          even: "node(6)",
          evenHead: "node(2)",
          oddNext: "null",
          evenNext: "null",
          oddPos: 4,
          evenPos: 5,
          codeLine: 9,
          insight: "üéâ The magic connection! 2‚Üí4‚Üí6‚Üí1‚Üí3‚Üí5",
          action: "connect",
          oddChainVals: [1, 3, 5],
          evenChainVals: [2, 4, 6],
        },
        {
          description: "Return evenHead (node 2). Final list: 2‚Üí4‚Üí6‚Üí1‚Üí3‚Üí5‚Üínull",
          odd: "node(5)",
          even: "node(6)",
          evenHead: "node(2)",
          oddNext: "null",
          evenNext: "null",
          oddPos: 4,
          evenPos: 5,
          codeLine: 10,
          insight: "Done! O(n) time - single pass. O(1) space - just pointers!",
          action: "done",
          oddChainVals: [1, 3, 5],
          evenChainVals: [2, 4, 6],
        },
      ];

      // DOM elements
      const originalListEl = document.getElementById("originalList");
      const evenChainEl = document.getElementById("evenChain");
      const oddChainEl = document.getElementById("oddChain");
      const resultListEl = document.getElementById("resultList");
      const stepNumberEl = document.getElementById("stepNumber");
      const stepDescEl = document.getElementById("stepDescription");
      const insightTextEl = document.getElementById("insightText");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const resetBtn = document.getElementById("resetBtn");
      const autoBtn = document.getElementById("autoBtn");
      const progressFill = document.getElementById("progressFill");
      const varOdd = document.getElementById("varOdd");
      const varEven = document.getElementById("varEven");
      const varEvenHead = document.getElementById("varEvenHead");
      const varOddNext = document.getElementById("varOddNext");
      const varEvenNext = document.getElementById("varEvenNext");

      // Render original list with pointers
      function renderOriginalList(oddPos, evenPos, rewiredLinks) {
        originalListEl.innerHTML = "";

        inputValues.forEach((val, idx) => {
          const node = document.createElement("div");
          node.className = "node";

          const isEven = (idx + 1) % 2 === 0;
          const colorClass = isEven ? "even-node" : "odd-node";

          let highlightClass = "";
          if (idx === oddPos) highlightClass = "highlight-odd";
          else if (idx === evenPos) highlightClass = "highlight-even";

          // Check if arrow should show as rewired
          const isRewired = rewiredLinks[idx] !== undefined;
          const arrowClass = isRewired ? "rewired" : "";

          let pointerHTML = "";
          if (idx === oddPos && idx === evenPos) {
            pointerHTML = `
                        <span class="pointer-indicator odd-ptr" style="left: 30%;">odd</span>
                        <span class="pointer-indicator even-ptr" style="left: 70%;">even</span>
                    `;
          } else if (idx === oddPos) {
            pointerHTML = `<span class="pointer-indicator odd-ptr">odd</span>`;
          } else if (idx === evenPos) {
            pointerHTML = `<span class="pointer-indicator even-ptr">even</span>`;
          }

          node.innerHTML = `
                    <div class="node-box ${colorClass} ${highlightClass}">
                        <span class="index-label">${idx + 1}</span>
                        ${val}
                        ${pointerHTML}
                    </div>
                    <span class="arrow ${arrowClass}">‚Üí</span>
                `;
          originalListEl.appendChild(node);
        });

        const nullNode = document.createElement("div");
        nullNode.className = "null-box";
        nullNode.textContent = "null";
        originalListEl.appendChild(nullNode);
      }

      // Render chain
      function renderChain(container, values, type) {
        container.innerHTML = "";

        if (values.length === 0) {
          const empty = document.createElement("span");
          empty.className = "empty-chain";
          empty.textContent = type === "even" ? "evenHead ‚Üí" : "head ‚Üí";
          container.appendChild(empty);
          return;
        }

        values.forEach((val, idx) => {
          const nodeDiv = document.createElement("div");
          nodeDiv.className = `chain-node ${type}`;
          nodeDiv.textContent = val;
          nodeDiv.style.animation = `pulse 0.4s ease ${idx * 0.1}s`;
          container.appendChild(nodeDiv);

          if (idx < values.length - 1) {
            const arrow = document.createElement("span");
            arrow.className = "chain-arrow";
            arrow.textContent = "‚Üí";
            container.appendChild(arrow);
          }
        });

        const arrow = document.createElement("span");
        arrow.className = "chain-arrow";
        arrow.textContent = "‚Üí";
        container.appendChild(arrow);

        const nullSpan = document.createElement("span");
        nullSpan.className = "empty-chain";
        nullSpan.textContent = "null";
        container.appendChild(nullSpan);
      }

      // Render result list
      function renderResultList(evenVals, oddVals, showResult) {
        if (!showResult) {
          resultListEl.innerHTML =
            '<span class="empty-chain">Waiting for final connection...</span>';
          return;
        }

        resultListEl.innerHTML = "";
        const allValues = [...evenVals, ...oddVals];

        allValues.forEach((val, idx) => {
          const node = document.createElement("div");
          node.className = "node";
          node.style.animation = `pulse 0.3s ease ${idx * 0.08}s`;

          const isFromEven = idx < evenVals.length;
          const colorClass = isFromEven ? "even-node" : "odd-node";

          node.innerHTML = `
                    <div class="node-box ${colorClass}">
                        ${val}
                    </div>
                    <span class="arrow">‚Üí</span>
                `;
          resultListEl.appendChild(node);
        });

        const nullNode = document.createElement("div");
        nullNode.className = "null-box";
        nullNode.textContent = "null";
        resultListEl.appendChild(nullNode);
      }

      // Update code highlighting
      function updateCodeHighlight(lineIdx) {
        for (let i = 0; i <= 10; i++) {
          const el = document.getElementById(`code${i}`);
          if (el) el.classList.remove("active");
        }
        if (lineIdx >= 0 && lineIdx <= 10) {
          const el = document.getElementById(`code${lineIdx}`);
          if (el) el.classList.add("active");
        }
      }

      // Apply step
      function applyStep(stepIdx) {
        const step = steps[stepIdx];

        // Update step info
        stepNumberEl.textContent = `Step ${stepIdx} / ${steps.length - 1}`;
        stepDescEl.textContent = step.description;
        insightTextEl.textContent = step.insight;

        // Update variables display
        varOdd.textContent = step.odd;
        varEven.textContent = step.even;
        varEvenHead.textContent = step.evenHead;
        varOddNext.textContent = step.oddNext;
        varEvenNext.textContent = step.evenNext;

        // Update progress
        progressFill.style.width = `${(stepIdx / (steps.length - 1)) * 100}%`;

        // Update code highlight
        updateCodeHighlight(step.codeLine);

        // Track rewired links
        if (step.rewire) {
          rewiredLinks[step.rewire.from] = step.rewire.to;
        }

        // Render original list
        renderOriginalList(step.oddPos, step.evenPos, rewiredLinks);

        // Render chains
        renderChain(evenChainEl, step.evenChainVals, "even");
        renderChain(oddChainEl, step.oddChainVals, "odd");

        // Render result (only on connect or done)
        const showResult = step.action === "connect" || step.action === "done";
        renderResultList(step.evenChainVals, step.oddChainVals, showResult);

        // Update buttons
        prevBtn.disabled = stepIdx === 0;
        nextBtn.disabled = stepIdx === steps.length - 1;
      }

      // Reset state
      function resetState() {
        rewiredLinks = {};
        oddChain = [];
        evenChain = [];
        resultNodes = [];
      }

      // Navigation
      function goToStep(stepIdx) {
        if (stepIdx < 0 || stepIdx >= steps.length) return;

        if (stepIdx < currentStep) {
          // Going backwards - rebuild rewiredLinks up to this point
          resetState();
          for (let i = 0; i <= stepIdx; i++) {
            if (steps[i].rewire) {
              rewiredLinks[steps[i].rewire.from] = steps[i].rewire.to;
            }
          }
        } else if (steps[stepIdx].rewire) {
          rewiredLinks[steps[stepIdx].rewire.from] = steps[stepIdx].rewire.to;
        }

        currentStep = stepIdx;
        applyStep(currentStep);
      }

      function nextStep() {
        goToStep(currentStep + 1);
      }

      function prevStep() {
        goToStep(currentStep - 1);
      }

      function reset() {
        stopAutoPlay();
        resetState();
        currentStep = 0;
        applyStep(0);
      }

      // Auto play
      function toggleAutoPlay() {
        if (autoPlayInterval) {
          stopAutoPlay();
        } else {
          startAutoPlay();
        }
      }

      function startAutoPlay() {
        autoBtn.textContent = "‚è∏ Pause";
        autoBtn.classList.add("playing");
        autoPlayInterval = setInterval(() => {
          if (currentStep < steps.length - 1) {
            nextStep();
          } else {
            stopAutoPlay();
          }
        }, 2000);
      }

      function stopAutoPlay() {
        autoBtn.textContent = "‚ñ∂ Auto Play";
        autoBtn.classList.remove("playing");
        if (autoPlayInterval) {
          clearInterval(autoPlayInterval);
          autoPlayInterval = null;
        }
      }

      // Event listeners
      prevBtn.addEventListener("click", prevStep);
      nextBtn.addEventListener("click", nextStep);
      resetBtn.addEventListener("click", reset);
      autoBtn.addEventListener("click", toggleAutoPlay);

      // Keyboard navigation
      document.addEventListener("keydown", (e) => {
        if (e.key === "ArrowRight" || e.key === " ") {
          e.preventDefault();
          nextStep();
        } else if (e.key === "ArrowLeft") {
          e.preventDefault();
          prevStep();
        } else if (e.key === "r" || e.key === "R") {
          reset();
        }
      });

      // Initialize
      applyStep(0);
    </script>
  </body>
</html>
